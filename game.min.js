!function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){(function(t){(function(){"use strict";i(32),t.mergeES5(),window.ig=t,i(6)}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";var e=t.exports={_importES5:!1,_storedData:{modules:[],requires:[],defines:[]},modules:{},requirecontext:i(33),module:function(t){return t?(this._importES5?this.modules[t]||(this.modules[t]=!0):this._storedData.modules.push(t),this):this},requires:function(){var t=this,e=Array.from(arguments);return this._importES5?(e.map(function(e){"dom.ready"===e?t._ready=!0:t.require(e)}),this):(this._storedData.requires.push(e),this)},require:function(t){if(!this.modules[t]&&"impact.impact"!==t){var e="./"+t.split(".").join("/")+".js";this.requirecontext(e)}},defines:function(t){this._importES5?t():this._storedData.defines.push(t)},mergeES5:function(){var t=this;for(var e in window.ig)!this.hasOwnProperty(e)&&window.ig.hasOwnProperty(e)&&(this[e]=window.ig[e]);this.setVendorAttribute=window.ig.setVendorAttribute,this.getVendorAttribute=window.ig.getVendorAttribute,this.normalizeVendorAttribute=window.ig.normalizeVendorAttribute,this._importES5=!0,this._storedData.modules.map(function(e){return t.module(e)}),this._storedData.requires.map(function(e){return t.requires.apply(t,e)}),this._storedData.defines.map(function(e){return t.defines(e)})},bindProperties:function(t,e){for(var i in e)t.prototype[i]=e[i];return t},_DOMReady:function(){return!!this._ready},setVendorAttribute:function(t,e,i){window.ig.setVendorAttribute(t,e,i)},getVendorAttribute:function(t,e){return window.ig.getVendorAttribute(t,e)},normalizeVendorAttribute:function(t,e){window.ig.normalizeVendorAttribute(t,e)}};t.export=e}).call(window)}).call(e,i(53)(t))},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffSpawner=e.EntityBuff=e.Buff=void 0;var a=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(5),u=i(3),h=i(4);t.require("impact.entity");var c=e.Buff=function(){function t(){o(this,t),this.name="Buff",this.description="This buff does X, Y, and Z.",this.targets=t.REMOVE.NONE,this.removal=t.REMOVE.NEVER,this.charges=0,this.lifespan=0,this.icon={x:0,y:0,width:0,height:0},this.player=null,this.from=null,this.hidden=!1}return r(t,[{key:"onApply",value:function(t){}},{key:"onUse",value:function(){return!0}},{key:"onUpdate",value:function(){}},{key:"onDraw",value:function(t){}},{key:"onEnd",value:function(){}}],[{key:"instantiateBuff",value:function(e){if("function"==typeof e)try{e=new e}catch(t){return console.error("Could not instantiate that buff",t,e),null}return e instanceof t?e:null}}]),t}();c.TARGET={NONE:0,SELF:1,OTHER:2,RANDOM:3,ALL:4},c.REMOVE={NEVER:0,NOW:1,LIFESPAN:2,CHARGES:3,EITHER:4,BOTH:5};var f=e.EntityBuff=function(e){function i(e,s,a){o(this,i);var r=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,s,{name:"EntityBuff"+ ++i.buffCounter,type:t.Entity.TYPE.NONE,checkAgainst:t.Entity.TYPE.NONE,size:{x:i.size,y:i.size},vel:{x:0,y:0},maxVel:{x:0,y:0},zIndex:8}));r.stage=i.STAGE.SPAWNING,r.spawnTimer=i.spawnTimer,r.stageTimer=0,r.buff=a.buff,r.spawner=a.spawner;for(var l=t.game.getEntitiesOfType(i),u=10;u>=0;u--)for(var h=0;h<l.length;h++)if(r.touches(l[h])){if(0===u){t.game.removeEntity(r);break}r.setPositionX(r.spawner.getSpawnX()),r.setPositionY(r.spawner.getSpawnY());break}return r}return s(i,e),r(i,[{key:"onCollisionEnter",value:function(e){if(e instanceof h.EntityBullet){if(e.ignoreBuffs)return;var i=t.game.getEntitiesOfType(u.Player).erase(e.player);switch(this.buff.targets){case c.TARGET.SELF:e.player.applyBuff(this.buff,e.player);break;case c.TARGET.OTHER:i[0].applyBuff(this.buff,e.player);break;case c.TARGET.RANDOM:i.random().applyBuff(this.buff,e.player);break;case c.TARGET.ALL:for(var n=0;n<i.length;n++)i[n].applyBuff(this.buff,e.player)}t.game.removeEntity(this)}}},{key:"update",value:function(){switch(a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"update",this).call(this),this.stage){case i.STAGE.SPAWNING:this.spawnTimer-=t.system.tick,this.spawnTimer<=0&&(this.spawnTimer=i.spawnTimer,this.stageTimer=i.boardLifespan,this.stage=i.STAGE.ONSTAGE,this.type=t.Entity.TYPE.BOTH,this.checkAgainst=t.Entity.TYPE.BOTH);break;case i.STAGE.ONSTAGE:this.stageTimer-=t.system.tick,this.stageTimer<=0&&(this.stageTimer=i.boardLifespan,this.stage=i.STAGE.DONE);break;case i.STAGE.DONE:t.game.removeEntity(this)}}},{key:"draw",value:function(){a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"draw",this).call(this);var e=t.system.context,n=t.game.spriteMain.getArea(this.buff.icon.x,this.buff.icon.y,this.buff.icon.width,this.buff.icon.height),s={x:this.getPositionX(),y:this.getPositionY()};switch(this.stage){case i.STAGE.SPAWNING:var o=i.size*Math.clamp(1-Math.normalise(this.spawnTimer,0,i.spawnTimer),.9,1);e.save(),e.globalAlpha=Math.clamp(1-Math.normalise(this.spawnTimer,0,i.spawnTimer),.4,.7),e.translate(s.x,s.y),e.rotate(-(Math.PI/2)),e.beginPath(),e.moveTo(0,0),e.arc(0,0,o/2,0,Math.PI*(2*(1-Math.clamp(Math.normalise(this.spawnTimer,0,i.spawnTimer),0,1)))),e.lineTo(0,0),e.clip(),e.closePath(),e.rotate(Math.PI/2),e.drawImage(n,0,0,50,50,-(o/2),-(o/2),o,o),e.restore();break;case i.STAGE.ONSTAGE:e.save(),e.globalAlpha=.9,e.translate(s.x,s.y),e.rotate(-(Math.PI/2)),e.beginPath(),e.moveTo(0,0),e.arc(0,0,i.size/2,0,2*Math.PI),e.lineTo(0,0),e.clip(),e.closePath(),e.rotate(Math.PI/2),e.drawImage(n,0,0,50,50,-(i.size/2),-(i.size/2),i.size,i.size),e.restore()}}}]),i}(l.Entity);f.buffCounter=0,f.spawnX=0,f.spawnMinimumY=0,f.spawnMaximumY=0,f.size=35,f.spawnScale=.8,f.spawnTimer=3,f.boardLifeSpan=10,f.spawnStagger=3,f.firstSpawnStagger=1,f.STAGE={UNSPAWNED:0,SPAWNING:1,ONSTAGE:2,DONE:3};e.BuffSpawner=function(){function e(){o(this,e);for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];this.cache=i?i:[],this.stage=[],this.spawnTimer=f.spawnStagger-f.firstSpawnStagger}return r(e,[{key:"update",value:function(){this.spawnTimer+=t.system.tick,this.spawnTimer>=f.spawnStagger&&(this.spawnTimer-=f.spawnStagger,this.cache.length>0&&t.game.spawnEntity(f,this.getSpawnX(),this.getSpawnY(),{buff:new(this.cache[Math.randomInt(0,this.cache.length-1)]),spawner:this}))}},{key:"getSpawnX",value:function(){return 0}},{key:"getSpawnY",value:function(){return 0}},{key:"registerBuff",value:function(t){this.cache.push(t)}}]),e}()}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)},u=i(6),h=i(5),c=i(29),f=n(c),p=i(4),d=i(2),y=i(14),m=i(16),g=e.Player=function(e){function i(e,n,a,r,l){s(this,i);var u=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,n,{size:{x:i.width,y:i.height},vel:{x:0,y:0},maxVel:{x:0,y:i.maxVelY},zIndex:9}));return u.angle={x:0,y:0},u.keyStates={up:!1,down:!1,using:!1},t.input.bind(a,"PLAYER_"+u.id+"_UP"),t.input.bind(r,"PLAYER_"+u.id+"_DOWN"),t.input.bind(l,"PLAYER_"+u.id+"_FIRING"),u.score=0,u.colour="#FFF",u.health=i.baseHealth,u.energy=i.baseEnergy,u.speed=i.baseMovementSpeed,u.healthRegeneration=i.baseHealthRegeneration,u.energyRegeneration=i.baseEnergyRegeneration,u.exhausted=!1,u.dead=!1,u.isMovable=i.defaultMovability,u.isActive=i.defaultActivity,u.isTargetable=i.defaultTargetability,u.isDamageable=i.defaultDamageability,u.isRegeneratingHealth=i.defaultRegenerateHealth,u.isRegeneratingEnergy=i.defaultRegenerateEnergy,u.hasMovementCost=i.defaultHaveMovementCosts,u.hasActivityCost=i.defaultHaveActivityCosts,u.isWeaponEnabled=i.defaultWeaponStatus,u.isBuffable=i.defaultBuffability,u.ammunition=[],u.buffs=[],u.applyBuff(m.BuffOfExhaustion,u),u.events=new f.EventEmitter,u.events.on("killed",function(){this.score++}.bind(u)),u}return a(i,e),r(i,[{key:"ready",value:function(){this.events.emit("spawned",this)}},{key:"update",value:function(){this.keyStates.up=t.input.state("PLAYER_"+this.id+"_UP")||!1,this.keyStates.down=t.input.state("PLAYER_"+this.id+"_DOWN")||!1,this.keyStates.using=t.input.pressed("PLAYER_"+this.id+"_FIRING")||!1,this.maxVel.y=i.maxVelY,this.speed=i.baseMovementSpeed,this.vel.y=0,this.healthRegeneration=i.baseHealthRegeneration,this.energyRegeneration=i.baseEnergyRegeneration,this.isMovable=i.defaultMovability,this.isActive=i.defaultActivity,this.isTargetable=i.defaultTargetability,this.isDamageable=i.defaultDamageability,this.isRegeneratingHealth=i.defaultRegenerateHealth,this.isRegeneratingEnergy=i.defaultRegenerateEnergy,this.hasMovementCost=i.defaultHaveMovementCosts,this.hasActivityCost=i.defaultHaveActivityCosts,this.isWeaponEnabled=i.defaultWeaponStatus,this.isBuffable=i.defaultBuffability;for(var e=0;e<this.buffs.length;e++){var n=this.buffs[e];if(n.lifespan-=t.system.tick,n.lifespan<=0)switch(n.lifespan=0,n.removal){case d.Buff.REMOVE.EITHER:case d.Buff.REMOVE.LIFESPAN:n.onEnd(),this.buffs.splice(e,1);continue}if(n.charges>0)this.isActive&&this.keyStates.using&&n.onUse()&&n.charges--;else switch(n.charges=0,n.removal){case d.Buff.REMOVE.EITHER:case d.Buff.REMOVE.CHARGES:n.onEnd(),this.buffs.splice(e,1);continue}if(n.lifespan<=0&&n.charges<=0)switch(n.removal){case d.Buff.REMOVE.EITHER:case d.Buff.REMOVE.BOTH:n.onEnd(),this.buffs.splice(e,1);continue}n.removal!==d.Buff.REMOVE.NOW?n.onUpdate():(n.onEnd(),this.buffs.splice(e,1))}if(this.speed<0&&(this.speed=0),!this.dead){var s=i.movementCost*t.system.tick;this.hasMovementCost&&this.energy<s&&(this.isMovable=!1),this.isMovable&&(this.keyStates.up&&!this.keyStates.down?(this.vel.y=-this.speed,this.hasMovementCost&&(this.energy-=s),this.events.emit("movement",this)):!this.keyStates.up&&this.keyStates.down&&(this.vel.y=this.speed,this.hasMovementCost&&(this.energy-=s),this.events.emit("movement",this)))}this.isRegeneratingHealth&&this.healthRegeneration>0&&(this.health+=this.healthRegeneration*t.system.tick,this.events.emit("health_regenerated",this)),this.isRegeneratingEnergy&&this.energyRegeneration>0&&(this.energy+=this.energyRegeneration*t.system.tick,this.events.emit("energy_regenerated",this)),this.isWeaponEnabled&&this.isActive&&this.keyStates.using&&(!this.hasActivityCost||this.energy>=i.activityCost)&&(this.ammunition.length>0?this.ammunition.shift()():this.fire(),this.hasActivityCost&&(this.energy-=i.activityCost)),l(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"update",this).call(this),this.health=Math.clamp(this.health,0,i.baseHealth),this.energy=Math.clamp(this.energy,0,i.baseEnergy),this.setPositionY(Math.clamp(this.getPositionY(),i.positionMinimumY,i.positionMaximumY)),this.score=Math.clamp(this.score,0,i.maxScore)}},{key:"draw",value:function(){var e=t.system.context;if(u.Game.debug){var n=i.positionMinimumY-i.height/2,s=i.positionMaximumY+i.height/2;e.lineWidth=1,e.strokeStyle=this.colour,e.beginPath(),e.moveTo(this.getPositionX(),n),e.lineTo(this.getPositionX(),s),e.stroke(),e.beginPath(),e.moveTo(this.getPositionX()-i.width/2,n),e.lineTo(this.getPositionX()+i.width/2,n),e.stroke(),e.beginPath(),e.moveTo(this.getPositionX()-i.width/2,s),e.lineTo(this.getPositionX()+i.width/2,s),e.stroke()}l(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"draw",this).call(this),this.drawPlayerBar(e);for(var o=0;o<this.buffs.length;o++)this.buffs[o].onDraw(e)}},{key:"drawPlayerBar",value:function(t){}},{key:"hasBuff",value:function(t){if("function"!=typeof t){if(!(t instanceof d.Buff))return null;t=t.constructor}for(var e=0;e<this.buffs.length;e++)if(t===this.buffs[e].constructor)return this.buffs[e];return null}},{key:"applyBuff",value:function(t,e){if(this.isBuffable){var i=this.hasBuff(t);null!==i?i.onApply(!0):(t=d.Buff.instantiateBuff(t),null!==t&&(t.player=this,t.from=e,t.onApply(!1),this.buffs.push(t)))}}},{key:"removeBuff",value:function(t){var e=this.hasBuff(t);null!=e&&this.buffs.erase(e)}},{key:"flushBuffs",value:function(){this.buffs=[]}},{key:"addAmmunition",value:function(t){this.ammunition.push(t)}},{key:"fire",value:function(){t.game.spawnEntity(i.ammunition,this.firePositionX(),this.getPositionY(),this)}},{key:"firePositionX",value:function(){throw new Error("Not implemented!")}},{key:"lookDirection",value:function(){throw new Error("Not implemented!")}},{key:"receiveDamage",value:function(t,e){this.isDamageable&&(this.health-=t,this.events.emit("damaged",this,t,e),e instanceof i&&e.events.emit("dealt",e,t,this),this.health<=0&&(this.applyBuff(y.BuffOfDeath,this),e instanceof i&&e.events.emit("killed",this)))}}]),i}(h.Entity);g.positionMargin=0,g.playerOneX=0,g.playerTwoX=0,g.positionMinimumY=0,g.positionMaximumY=0,g.maxScore=999,g.width=30,g.height=45,g.maxVelY=600,g.healthBarColour="#00CC33",g.energyBarColour="#E68E00",g.statusBarWidth=200,g.statusBarHeight=3,g.buffDisplaySize=15,g.scoreDisplaySize=25,g.baseHealth=100,g.baseEnergy=100,g.baseHealthRegeneration=5,g.baseEnergyRegeneration=40,g.baseMovementSpeed=200,g.defaultMovability=!0,g.defaultActivity=!0,g.defaultTargetability=!0,g.defaultDamageability=!0,g.defaultRegenerateHealth=!0,g.defaultRegenerateEnergy=!0,g.defaultHaveMovementCosts=!0,g.defaultHaveActivityCosts=!0,g.defaultWeaponStatus=!0,g.defaultBuffability=!0,g.movementCost=30,g.activityCost=10,g.exhaustionThreshold=10,g.ammunition=p.EntityBullet}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.EntityBullet=e.BulletDefaults=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)},l=i(5),u=i(3);t.requires("impact.entity");var h=e.BulletDefaults={width:7,height:5,speed:400,maxVel:{x:1e3,y:1e3},damage:20};e.EntityBullet=function(e){function i(t,e,o){n(this,i);var a=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,{size:{x:h.width,y:h.height},vel:{x:o.angle.x*h.speed,y:0},maxVel:h.maxVel,zIndex:8,type:o.type,checkAgainst:o.checkAgainst}));return a.drawBullet=!0,a.color="#000",a.player=o,a.damage=h.damage,a.ignoreBuffs=!1,a}return o(i,e),a(i,[{key:"onCollisionEnter",value:function(e){e instanceof u.Player&&e!==this.player&&(e.receiveDamage(this.damage,this.player),t.game.removeEntity(this))}},{key:"update",value:function(){r(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"update",this).call(this),this.touches(t.game.board)||t.game.removeEntity(this)}},{key:"draw",value:function(){r(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"draw",this).call(this);var e=t.system.context;this.drawBullet&&(e.beginPath(),e.fillStyle=this.color,e.fillRect(this.pos.x,this.pos.y,this.size.x,this.size.y),e.stroke())}}]),i}(l.Entity);t.module("game.entities.bullet").requires("impact.entity").defines(function(){t.Entity.extend({name:"Bullet",collides:t.Entity.COLLIDES.NEVER,size:{x:7,y:5},pos:{x:0,y:0},vel:{x:0,y:0},maxVel:{x:400,y:400},angle:0,speed:400,damage:5,exploding:0,canDamage:1,deathCount:0,animSheet:new t.AnimationSheet("media/explosion.png",100,100),check:function(t){1==this.canDamage&&(t.receiveDamage(this.damage),this.canDamage=0),this.damage>=50?0==this.exploding&&(this.vel.x=0,this.vel.y=0,this.pos.x=t.pos.x-50,this.pos.y-=50,this.size.x=100,this.size.y=100,this.currentAnim=this.anims.explode,this.exploding=1):this.kill(),this.checkAgainst=null},init:function(e,i,n){this.name="Bullet_"+Math.randomInt(1,1e4),e=parseFloat(String(e).replace(/[^\d.-]/g,""))||0,i=parseFloat(String(i).replace(/[^\d.-]/g,""))||0,n=n instanceof Object?n:{},this.pos.x=e,this.pos.y=i,this.speed="number"==typeof n.speed?n.speed:this.speed,this.angle="number"==typeof n.angle?n.angle:this.angle,this.vel.x=Math.cos(this.angle)*this.speed,this.vel.y=Math.sin(this.angle)*this.speed,this.checkAgainst="number"==typeof n.checkAgainst?n.checkAgainst:null,null==this.checkAgainst&&(this.checkAgainst=this.vel.x<0?t.Entity.TYPE.A:t.Entity.TYPE.B),this.type=1==this.checkAgainst?2:1,this.damage="number"==typeof n.damage?n.damage:this.damage,this.size.x=.7*this.damage,this.size.y=.5*this.damage,this.addAnim("explode",.03,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,72,73,74],!0),this.currentAnim=null},update:function(){this.parent(),(this.pos.x<0-this.size.x/2||this.pos.x>t.system.width+this.size.x/2)&&t.game.removeEntity(this),(this.pos.y<0-this.size.y/2||this.pos.y>t.system.height+this.size.y/2)&&t.game.removeEntity(this),0==this.exploding&&this.damage>=50&&(this.checkAgainst==t.Entity.TYPE.A&&this.pos.x>0&&this.pos.x<40&&(this.exploding=1,this.vel.x=0,this.vel.y=0,this.pos.x-=(100-this.pos.x)/50,this.pos.y-=(100-this.pos.y)/50,this.size.x=100,this.size.y=100,this.currentAnim=this.anims.explode),this.checkAgainst==t.Entity.TYPE.B&&this.pos.x<t.system.width&&this.pos.x>t.system.width-40&&(this.exploding=1,this.vel.x=0,this.vel.y=0,this.size.x=100,this.size.y=100,this.pos.x-=50,this.pos.y-=50,this.currentAnim=this.anims.explode)),1==this.exploding&&(this.deathCount+=t.system.tick,this.deathCount>1e3&&(this.canDamage=0),this.deathCount>1e4&&t.game.removeEntity(this))},draw:function(){if(this.currentAnim)this.currentAnim.draw(this.pos.x-this.offset.x-t.game._rscreen.x,this.pos.y-this.offset.y-t.game._rscreen.y);else{var e=t.system.context;e.save(),e.translate(this.pos.x,this.pos.y),e.rotate(this.angle),e.beginPath(),e.fillStyle="#000",e.fillRect(0-this.size.x/2,0-this.size.y/2,.9*this.size.x,.5*this.size.y),e.stroke(),e.restore()}}})})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)};t.requires("impact.entity");e.Entity=function(t){function e(t,s,o){i(this,e);var a=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,-(1/0),-(1/0),o));return a.name="Entity"+a.id,a.setPositionX(t),a.setPositionY(s),a.collidingWith=[],a}return s(e,t),o(e,[{key:"getPositionX",value:function(){return this.pos.x+this.size.x/2}},{key:"getPositionY",value:function(){return this.pos.y+this.size.y/2}},{key:"setPositionX",value:function(t){this.pos.x=t-this.size.x/2}},{key:"setPositionY",value:function(t){this.pos.y=t-this.size.y/2}},{key:"update",value:function(){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);for(var t=0;t<this.collidingWith.length;t++){var i=this.collidingWith[t];this.touches(i)||(this.onCollisionExit(i),this.collidingWith.splice(t,1))}}},{key:"check",value:function(t){this.collidingWith.indexOf(t)<0&&(this.collidingWith.push(t),this.onCollisionEnter(t)),this.onCollisionUpdate(t)}},{key:"onCollisionEnter",value:function(t){}},{key:"onCollisionExit",value:function(t){}},{key:"onCollisionUpdate",value:function(t){}}]),e}(t.Entity)}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)},l=i(7),u=i(3),h=(i(5),i(30)),c=i(31),f=i(2),p=i(10),d=i(11),y=i(8),m=i(12),g=i(13),v=i(15),b=i(17),w=i(18),E=i(19),_=i(20),x=i(21),O=i(22),P=i(23),k=i(24),M=i(25),S=i(26),T=i(27);t.require("impact.game");var A=e.Game=function(e){function i(){return n(this,i),s(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return o(i,e),a(i,[{key:"init",value:function(){this.board={pos:{x:0,y:0},size:{x:i.width,y:i.height}},this.spriteMain=new l.GameAsset(500,150,"media/sprite.png"),this.spriteExplosion=new l.GameAsset(900,900,"media/explosion.png"),this.spriteBackground=new l.GameAsset(900,900,"media/background.png"),this.buffSpawner=new(function(t){function e(){n(this,e);var t=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.registerBuff(p.BuffOfAftershock),t.registerBuff(d.BuffOfAgony),t.registerBuff(y.BuffOfBombage),t.registerBuff(m.BuffOfChains),t.registerBuff(g.BuffOfCover),t.registerBuff(v.BuffOfDodge),t.registerBuff(b.BuffOfHealing),t.registerBuff(w.BuffOfHell),t.registerBuff(E.BuffOfMissiles),t.registerBuff(_.BuffOfNetting),t.registerBuff(x.BuffOfOvercharge),t.registerBuff(O.BuffOfProtection),t.registerBuff(P.BuffOfPurgatory),t.registerBuff(k.BuffOfSlowness),t.registerBuff(M.BuffOfSniperage),t.registerBuff(S.BuffOfSpeed),t.registerBuff(T.BuffOfStatic),t}return o(e,t),a(e,[{key:"getSpawnX",value:function(){return f.EntityBuff.spawnX}},{key:"getSpawnY",value:function(){return Math.randomInt(f.EntityBuff.spawnMinimumY,f.EntityBuff.spawnMaximumY)}}]),e}(f.BuffSpawner)),this.playerOne=t.game.spawnEntity(h.EntityPlayerOne,u.Player.playerOneX,i.height/2),this.playerTwo=t.game.spawnEntity(c.EntityPlayerTwo,u.Player.playerTwoX,i.height/2);for(var e=0;e<this.entities.length;e++)this.entities[e].ready()}},{key:"update",value:function(){r(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"update",this).call(this),this.buffSpawner.update()}},{key:"draw",value:function(){var e=t.system.context;if(this.clearColor&&t.system.clear(this.clearColor),this.spriteBackground.hasLoaded()===!0&&e.drawImage(this.spriteBackground.get(),0,0,700,442,-50,-21,700,442),i.debug===!0){var n=f.EntityBuff.spawnMinimumY-f.EntityBuff.size/2,s=f.EntityBuff.spawnMaximumY+f.EntityBuff.size/2;e.lineWidth=1,e.strokeStyle="#00FF00",e.beginPath(),e.moveTo(f.EntityBuff.spawnX,n),e.lineTo(f.EntityBuff.spawnX,s),e.stroke(),e.beginPath(),e.moveTo(f.EntityBuff.spawnX-f.EntityBuff.size/2,n),e.lineTo(f.EntityBuff.spawnX+f.EntityBuff.size/2,n),e.stroke(),e.beginPath(),e.moveTo(f.EntityBuff.spawnX-f.EntityBuff.size/2,s),e.lineTo(f.EntityBuff.spawnX+f.EntityBuff.size/2,s),e.stroke()}this._rscreen.x=t.system.getDrawPos(this.screen.x)/t.system.scale,this._rscreen.y=t.system.getDrawPos(this.screen.y)/t.system.scale,this.entities.sort(function(t,e){return t.zIndex<e.zIndex?-1:e.zIndex<t.zIndex?1:0}),this.drawEntities()}},{key:"getEntitiesOfType",value:function(t){for(var e=[],i=0;i<this.entities.length;i++)this.entities[i]instanceof t&&e.push(this.entities[i]);return e}}]),i}(t.Game);A.width=600,A.height=400,A.debug=!1,u.Player.positionMargin=30,u.Player.playerOneX=u.Player.positionMargin,u.Player.playerTwoX=A.width-u.Player.positionMargin,u.Player.positionMinimumY=u.Player.positionMargin+u.Player.height/2,u.Player.positionMaximumY=A.height-u.Player.positionMargin-u.Player.height/2,f.EntityBuff.spawnX=A.width/2,f.EntityBuff.spawnMinimumY=A.height/4,f.EntityBuff.spawnMaximumY=A.height-f.EntityBuff.spawnMinimumY,t.main("#canvas",A,60,A.width,A.height,1)}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();t.require("impact.entity");var s=0;e.GameAsset=function(){function e(n,o,a){var r=this;i(this,e),this.name+=++s,this.areaCache={},this.image=t.Image.cache.hasOwnProperty(a)?t.Image.cache[a]:new t.Image(a),this.canvas=document.createElement("canvas"),this.canvas.width=n,this.canvas.height=o;var l=10,u=1e3*l,h=setInterval(function(){if(r.image.loaded===!0){clearInterval(h);var e=r.canvas.getContext("2d");e.drawImage(r.image.data,0,0,r.image.width,r.image.height,0,0,n,o)}else if(u-=l,u<=0)throw clearInterval(h),t.game.removeEntity(r),new Error("Image load timeout.")}.bind(this),l)}return n(e,[{key:"hasLoaded",value:function(){return this.image&&this.image.loaded===!0}},{key:"get",value:function(){return this.canvas}},{key:"getArea",value:function(t,e,i,n){if(this.image.loaded===!0){var s="("+t+","+e+":"+i+","+n+")",o=document.createElement("canvas"),a=o.getContext("2d");return a.drawImage(this.canvas,t,e,i,n,0,0,i,n),this.areaCache[s]=o,o}return document.createElement("canvas")}}]),e}()}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.EntityBombExplosion=e.EntityBombBullet=e.BuffOfBombage=void 0;var a=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(2),u=(i(5),i(4)),h=i(3),c=(e.BuffOfBombage=function(e){function i(){n(this,i);var t=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.name="Grenade Launcher",t.description="Fires a grenade!",t.targets=l.Buff.TARGET.SELF,t.removal=l.Buff.REMOVE.CHARGES,t.charges=0,t.icon={x:50,y:0,width:50,height:50},t}return o(i,e),r(i,[{key:"onApply",value:function(t){this.charges+=1,this.player.addAmmunition(this.fire.bind(this))}},{key:"onUse",value:function(){return!1}},{key:"fire",value:function(){t.game.spawnEntity(c,this.player.firePositionX(),this.player.getPositionY(),this.player),this.charges--}}]),i}(l.Buff),e.EntityBombBullet=function(e){function i(t,e,o){n(this,i);var a=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,o));return a.size={x:40,y:25},a.setPositionX(t+a.size.x/2*o.lookDirection()),a.setPositionY(e),a.damage=0,a}return o(i,e),r(i,[{key:"onCollisionEnter",value:function(e){e instanceof h.Player&&e!==this.player&&(t.game.spawnEntity(f,this.getPositionX(),this.getPositionY(),this.player),t.game.removeEntity(this))}}]),i}(u.EntityBullet)),f=e.EntityBombExplosion=function(e){function i(e,o,a){n(this,i);var r=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,o,a));return r.size={x:50,y:50},r.setPositionX(e),r.setPositionY(o),r.ignoreBuffs=!0,r.drawBullet=!1,r.vel={x:0,y:0},r.zIndex=10,r.animSheet=new t.AnimationSheet(null,100,100),r.animSheet.image=t.game.spriteExplosion.image,
r.addAnim("explode",.03,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,72,73,74],!0),r.currentAnim=r.anims.explode,r.damage=60,r}return o(i,e),r(i,[{key:"update",value:function(){a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"update",this).call(this),this.currentAnim.loopCount>0&&t.game.removeEntity(this)}},{key:"onCollisionEnter",value:function(t){t instanceof h.Player&&t!==this.player&&t.receiveDamage(this.damage,this.player)}}]),i}(u.EntityBullet)}).call(window)}).call(e,i(1))},function(t,e){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),n=e.ScoreIcons=[{x:450,y:100,width:50,height:50},{x:0,y:100,width:50,height:50},{x:50,y:100,width:50,height:50},{x:100,y:100,width:50,height:50},{x:150,y:100,width:50,height:50},{x:200,y:100,width:50,height:50},{x:250,y:100,width:50,height:50},{x:300,y:100,width:50,height:50},{x:350,y:100,width:50,height:50},{x:400,y:100,width:50,height:50}];e.Score=function(){function e(){t(this,e)}return i(e,null,[{key:"convertScoreToIcon",value:function(t){for(var e=0==t?[n[0]]:[];t/10>0;)e.push(n[t%10]),t=Math.floor(t/10);return e.reverse(),e}}]),e}()}).call(window)},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfAftershock=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2);i(3),e.BuffOfAftershock=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="Mirror Hit",e.description="Every time you deal damage, you will automatically fire another bullet for free.",e.targets=a.Buff.TARGET.SELF,e.removal=a.Buff.REMOVE.LIFESPAN,e.lifespan=0,e.icon={x:300,y:50,width:50,height:50},e.damage=20,e.dealtEvent=e.onDamageDealt.bind(e),e}return s(i,e),o(i,[{key:"onApply",value:function(t){this.lifespan=5,t||this.player.events.on("dealt",this.dealtEvent)}},{key:"onEnd",value:function(){this.player.events.off("dealt",this.dealtEvent)}},{key:"onDamageDealt",value:function(t,e,i){e>5&&t.fire()}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfAgony=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(2);e.BuffOfAgony=function(e){function i(){n(this,i);var t=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.name="Curse!",t.description="Curses the target with agony, damaging them over time!",t.targets=r.Buff.TARGET.OTHER,t.removal=r.Buff.REMOVE.LIFESPAN,t.lifespan=0,t.icon={x:0,y:0,width:50,height:50},t.damage=20,t}return o(i,e),a(i,[{key:"onApply",value:function(t){this.lifespan=2}},{key:"onUpdate",value:function(){this.player.receiveDamage(this.damage*t.system.tick,this.from)}}]),i}(r.Buff)}).call(window)}).call(e,i(1))},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfChains=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(6),r=i(2);e.BuffOfChains=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="Hooked!",e.description="Drags the unfortunate soul towards the centre of their zone.",e.targets=r.Buff.TARGET.OTHER,e.removal=r.Buff.REMOVE.LIFESPAN,e.lifespan=0,e.icon={x:250,y:50,width:50,height:50},e.color="#1b602b",e.chainPos={x:0,y:0},e}return s(i,e),o(i,[{key:"onApply",value:function(t){this.lifespan+=1.7,this.chainPos.x=this.player.getPositionX(),this.chainPos.y=a.Game.height/2}},{key:"onUpdate",value:function(){this.player.isMovable=!1,this.player.getPositionY()<this.chainPos.y-10?this.player.vel.y=30:this.player.getPositionY()>this.chainPos.y+10?this.player.vel.y=-30:this.removal=r.Buff.REMOVE.NOW}},{key:"onDraw",value:function(t){t.save(),t.beginPath(),t.lineWidth=10,t.strokeStyle=this.color,t.setLineDash([20,20]),t.moveTo(this.chainPos.x,this.chainPos.y),t.lineTo(this.player.getPositionX(),this.player.getPositionY()),t.stroke(),t.restore()}}]),i}(r.Buff)}).call(window)},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.EntityWall=e.BuffOfCover=void 0;var a=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(2),u=i(4),h=(e.BuffOfCover=function(e){function i(){n(this,i);var t=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.name="Cover me",t.description="Summons a wall for a short time that will block all projectiles.",t.targets=l.Buff.TARGET.SELF,t.removal=l.Buff.REMOVE.CHARGES,t.charges=0,t.icon={x:200,y:50,width:50,height:50},t}return o(i,e),r(i,[{key:"onApply",value:function(t){this.charges+=1}},{key:"onUse",value:function(){return t.game.spawnEntity(h,this.player.firePositionX(),this.player.getPositionY(),this.player),!0}},{key:"onUpdate",value:function(){this.player.isWeaponEnabled=!1}}]),i}(l.Buff),e.EntityWall=function(e){function i(t,e,o){n(this,i);var a=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,o));a.size={x:20,y:80};var r=100;return a.setPositionX(t+(a.size.x/2+r)*o.lookDirection()),a.setPositionY(e),a.vel=a.maxVel={x:0,y:0},a.lifespan=4,a.color="#b2b2b2",a}return o(i,e),r(i,[{key:"update",value:function(){a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"update",this).call(this),this.lifespan-=t.system.tick,this.lifespan<0&&t.game.removeEntity(this)}},{key:"onCollisionEnter",value:function(e){e instanceof u.EntityBullet&&t.game.removeEntity(e)}}]),i}(u.EntityBullet))}).call(window)}).call(e,i(1))},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfDeath=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2),r=i(3);e.BuffOfDeath=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="You be dead.",e.description="Revives the target, resetting their health and making them immune to damage for a short time.",e.targets=a.Buff.TARGET.SELF,e.removal=a.Buff.REMOVE.LIFESPAN,e.lifespan=0,e.icon={x:400,y:0,width:50,height:50},e}return s(i,e),o(i,[{key:"onApply",value:function(t){this.lifespan=2.5,this.player.flushBuffs(),this.player.health=0,this.player.dead=!0,this.player.events.emit("dead",this.player,!0)}},{key:"onUpdate",value:function(){this.player.isDamageable=!1,this.player.isRegeneratingHealth=!1,this.player.isBuffable=!1}},{key:"onEnd",value:function(){this.player.health=r.Player.baseHealth,this.player.dead=!1,this.player.events.emit("dead",this.player,!1)}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfDodge=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2),r=i(3);e.BuffOfDodge=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="Dodge!",e.description="Teleports the player to the opposite side of their area.",e.targets=a.Buff.TARGET.SELF,e.removal=a.Buff.REMOVE.CHARGES,e.charges=0,e.icon={x:50,y:50,width:50,height:50},e}return s(i,e),o(i,[{key:"onApply",value:function(t){this.charges+=1}},{key:"onUse",value:function(){if(this.player.isMovable){var t=1-Math.normalise(this.player.getPositionY(),r.Player.positionMinimumY,r.Player.positionMaximumY);return this.player.setPositionY(Math.lerp(t,r.Player.positionMinimumY,r.Player.positionMaximumY)),!0}return!1}},{key:"onUpdate",value:function(){this.player.isWeaponEnabled=!1}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfExhaustion=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2),r=i(3);e.BuffOfExhaustion=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="Exhausted",e.description="Low energy means moving slower!",e.targets=a.Buff.TARGET.SELF,e.removal=a.Buff.REMOVE.NEVER,e.icon={x:350,y:0,width:50,height:50},e.hidden=!0,e.exhausted=!1,e}return s(i,e),o(i,[{key:"onUpdate",value:function(){this.player.energy<=r.Player.exhaustionThreshold?(this.player.maxVel.y=.1*r.Player.baseMovementSpeed,this.hidden=!1,this.exhausted||(this.player.events.emit("exhausted",this.player,!0),this.exhausted=!0)):(this.hidden=!0,this.exhausted&&(this.player.events.emit("exhausted",this.player,!1),this.exhausted=!1))}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfHealing=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2);e.BuffOfHealing=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="I Need Healing!",e.description="Heals the target a significant amount over time.",e.targets=a.Buff.TARGET.SELF,e.removal=a.Buff.REMOVE.LIFESPAN,e.lifespan=5,e.icon={x:150,y:0,width:50,height:50},e.healing=50,e}return s(i,e),o(i,[{key:"onUpdate",value:function(){this.player.isRegeneratingHealth&&(this.player.healthRegeneration+=this.healing)}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.EntityMeteor=e.EntityCrosshair=e.BuffOfHell=void 0;var a=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(2),u=i(5),h=i(3),c=i(8),f=(e.BuffOfHell=function(e){function i(){n(this,i);var t=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.name="Summon a meteor from hell!",t.description="Fires a grenade!",t.targets=l.Buff.TARGET.SELF,t.removal=l.Buff.REMOVE.CHARGES,t.charges=0,t.icon={x:300,y:0,width:50,height:50},t}return o(i,e),r(i,[{key:"onApply",value:function(t){this.charges+=1,this.player.addAmmunition(this.fire.bind(this))}},{key:"onUse",value:function(){return!1}},{key:"fire",value:function(){for(var e=t.game.getEntitiesOfType(h.Player).erase(this.player),i=0;i<e.length;i++)t.game.spawnEntity(f,e[i].getPositionX(),e[i].getPositionY(),this.player);this.charges--}}]),i}(l.Buff),e.EntityCrosshair=function(e){function i(t,e,o){n(this,i);var a=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,{size:{x:50,y:50}}));return a.rotation=0,a.icon={x:450,y:50,width:50,height:50},a.player=o,a.coundown=2,a}return o(i,e),r(i,[{key:"update",value:function(){a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"update",this).call(this),this.coundown-=t.system.tick,this.coundown<=0&&(t.game.spawnEntity(p,this.getPositionX(),this.getPositionY(),this.player),t.game.removeEntity(this))}},{key:"draw",value:function(){a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"draw",this).call(this);var e=t.system.context,n=t.game.spriteMain.getArea(this.icon.x,this.icon.y,this.icon.width,this.icon.height);e.save(),e.translate(this.getPositionX(),this.getPositionY()),e.rotate(this.rotation+=.07),e.drawImage(n,0,0,50,50,-(this.size.x/2),-(this.size.y/2),this.size.x,this.size.y),e.restore()}}]),i}(u.Entity)),p=e.EntityMeteor=function(t){function e(t,i,o){n(this,e);var a=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,o));return a.size={x:100,y:100},a.setPositionX(t),a.setPositionY(i),a.damage=90,a}return o(e,t),e}(c.EntityBombExplosion)}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.EntityGuidedMissile=e.BuffOfMissiles=void 0;var a=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(2),u=i(4),h=i(3),c=i(28),f=(e.BuffOfMissiles=function(e){function i(){n(this,i);var t=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.name="Definitely not Kai'Sa Q!",t.description="Launches ten heat seeking missiles; enemy lock-on is random.",t.targets=l.Buff.TARGET.SELF,t.removal=l.Buff.REMOVE.NEVER,t.charges=0,t.icon={x:100,y:50,width:50,height:50},t.missilesToSpawn=0,t.delayTillNext=0,t}return o(i,e),r(i,[{key:"onApply",value:function(t){this.charges+=1,this.player.addAmmunition(this.fire.bind(this))}},{key:"onUse",value:function(){return!1}},{key:"fire",value:function(){this.missilesToSpawn=60,this.charges--}},{key:"onUpdate",value:function(){if(this.delayTillNext-=t.system.tick,this.delayTillNext<=0)if(this.missilesToSpawn-- >0){var e=t.game.spawnEntity(f,this.player.firePositionX(),this.player.getPositionY(),this.player);e.from={x:this.player.getPositionX(),y:Math.randomFloat(e.pos.y-3,e.pos.y+3)},e.target=t.game.getEntitiesOfType(h.Player).erase(this.player).random(),e.pos.y=e.from.y,this.delayTillNext+=Math.randomFloat(.3,.7),e.duration=Math.randomFloat(1,1.2),e.remaining=Math.randomFloat(1,1.2),e.missileXTween=[c.Easing.Quartic.EaseOut,c.Easing.Quartic.EaseIn,c.Easing.Circular.EaseInOut,c.Easing.Exponential.EaseInOut].random(),e.missileYTween=[c.Easing.Back.EaseIn,c.Easing.Back.EaseInOut].random()}else this.missilesToSpawn=0;else this.delayTillNext=0;this.charges<=0&&(this.hide=!0,this.missilesToSpawn<=0&&(this.removal=l.Buff.REMOVE.NOW))}}]),i}(l.Buff),e.EntityGuidedMissile=function(e){function i(t,e,o){n(this,i);var a=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,o));return a.size={x:5,y:5},a.setPositionX(t+a.size.x/2*o.lookDirection()),a.setPositionY(e),a.damage=.5,a.target=null,a.ignoreBuffs=!0,a.color="#7a07c1",a}return o(i,e),r(i,[{key:"update",value:function(){a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"update",this).call(this),this.remaining-=t.system.tick;var e=Math.normalise(this.remaining<=0?0:this.remaining,this.duration,0);this.pos.x=Math.lerp(this.missileXTween(e),this.from.x,this.target.getPositionX()),this.pos.y=Math.lerp(this.missileYTween(e),this.from.y,this.target.getPositionY()),this.remaining<=0&&t.game.removeEntity(this)}}]),i}(u.EntityBullet))}).call(window)}).call(e,i(1))},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfNetting=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2);e.BuffOfNetting=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="Netting",e.description="Prevents the target from moving.",e.targets=a.Buff.TARGET.OTHER,e.removal=a.Buff.REMOVE.LIFESPAN,e.lifespan=0,e.icon={x:0,y:50,width:50,height:50},e}return s(i,e),o(i,[{key:"onApply",value:function(t){this.lifespan=1}},{key:"onUpdate",value:function(){this.player.isMovable=!1}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfOvercharge=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2);e.BuffOfOvercharge=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="Double Buffs",e.description="Will double the current charges and lifespan of all buffs currently held by the player.",e.targets=a.Buff.TARGET.SELF,e.removal=a.Buff.REMOVE.NOW,e.icon={x:400,y:50,width:50,height:50},e}return s(i,e),o(i,[{key:"onApply",value:function(t){for(var e=0;e<this.player.buffs.length;e++){var i=this.player.buffs[e];i.lifespan>0&&(i.lifespan*=2),i.charges>0&&(i.charges*=2)}}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfProtection=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2);e.BuffOfProtection=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="The best offence is a good defence.",e.description="Makes the player immune to damage.",e.targets=a.Buff.TARGET.SELF,e.removal=a.Buff.REMOVE.LIFESPAN,e.lifespan=0,e.icon={x:200,y:0,width:50,height:50},e}return s(i,e),o(i,[{key:"onApply",value:function(t){this.lifespan=2}},{key:"onUpdate",value:function(){this.player.isDamageable=!1}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfPurgatory=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2);e.BuffOfPurgatory=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="Unwellness",e.description="The target will not regenerate health for a short time.",e.targets=a.Buff.TARGET.OTHER,e.removal=a.Buff.REMOVE.LIFESPAN,e.lifespan=0,e.icon={x:100,y:0,width:50,height:50},e}return s(i,e),o(i,[{key:"onApply",value:function(t){this.lifespan=4}},{key:"onUpdate",value:function(){this.player.isRegeneratingHealth=!1}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfSlowness=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2);e.BuffOfSlowness=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="Cold Feet.",e.description="The target will move slower for a short time.",e.targets=a.Buff.TARGET.OTHER,e.removal=a.Buff.REMOVE.LIFESPAN,e.lifespan=0,e.icon={x:450,y:0,width:50,height:50},e.speedLoss=150,e}return s(i,e),o(i,[{key:"onApply",value:function(t){this.lifespan=2}},{key:"onUpdate",value:function(){this.player.isMovable&&(this.player.speed-=this.speedLoss)}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.EntitySniperBullet=e.BuffOfSniperage=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(2),l=i(4),u=(e.BuffOfSniperage=function(e){function i(){n(this,i);var t=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.name="Sniperage",t.description="Fires a powerful, high speed shot.",t.targets=r.Buff.TARGET.SELF,t.removal=r.Buff.REMOVE.CHARGES,t.charges=0,t.icon={x:150,y:50,width:50,height:50},t}return o(i,e),a(i,[{key:"onApply",value:function(t){this.charges+=1,this.player.addAmmunition(this.fire.bind(this))}},{key:"onUse",value:function(){return!1}},{key:"fire",value:function(){t.game.spawnEntity(u,this.player.firePositionX(),this.player.getPositionY(),this.player),this.charges--}}]),i}(r.Buff),e.EntitySniperBullet=function(t){function e(t,i,o){n(this,e);var a=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,o));return a.size={x:40,y:10},a.setPositionX(t+a.size.x/2*o.lookDirection()),a.setPositionY(i),a.vel.x*=3,a.damage=70,a}return o(e,t),e}(l.EntityBullet))}).call(window)}).call(e,i(1))},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e;
}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfSpeed=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2);e.BuffOfSpeed=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="My Kingdom for a horse!",e.description="The player will move faster for a short period.",e.targets=a.Buff.TARGET.SELF,e.removal=a.Buff.REMOVE.LIFESPAN,e.lifespan=0,e.icon={x:250,y:0,width:50,height:50},e.speedBoost=100,e}return s(i,e),o(i,[{key:"onApply",value:function(t){this.lifespan=7}},{key:"onUpdate",value:function(){this.player.isMovable&&(this.player.speed+=this.speedBoost)}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BuffOfStatic=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2);i(3),e.BuffOfStatic=function(e){function i(){t(this,i);var e=n(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.name="An eye for an  eye.",e.description="Your attacker will be damaged for a percentage of what they deal to you.",e.targets=a.Buff.TARGET.SELF,e.removal=a.Buff.REMOVE.LIFESPAN,e.lifespan=0,e.icon={x:350,y:50,width:50,height:50},e.damage=20,e.damageEvent=e.onPlayerDamaged.bind(e),e}return s(i,e),o(i,[{key:"onApply",value:function(t){this.lifespan=10,t!==!0&&this.player.events.on("damaged",this.damageEvent)}},{key:"onEnd",value:function(){this.player.events.off("damaged",this.damageEvent)}},{key:"onPlayerDamaged",value:function(t,e,i){e>0&&i.receiveDamage(.4*e)}}]),i}(a.Buff)}).call(window)},function(t,e,i){(function(t){(function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Easing={Linear:{EaseNone:function(t){return t}},Quadratic:{EaseIn:function(t){return t*t},EaseOut:function(t){return-t*(t-2)},EaseInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{EaseIn:function(t){return t*t*t},EaseOut:function(t){return--t*t*t+1},EaseInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{EaseIn:function(t){return t*t*t*t},EaseOut:function(t){return-(--t*t*t*t-1)},EaseInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{EaseIn:function(t){return t*t*t*t*t},EaseOut:function(t){return(t-=1)*t*t*t*t+1},EaseInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{EaseIn:function(t){return-Math.cos(t*Math.PI/2)+1},EaseOut:function(t){return Math.sin(t*Math.PI/2)},EaseInOut:function(t){return-.5*(Math.cos(Math.PI*t)-1)}},Exponential:{EaseIn:function(t){return 0===t?0:Math.pow(2,10*(t-1))},EaseOut:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},EaseInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{EaseIn:function(t){return-(Math.sqrt(1-t*t)-1)},EaseOut:function(t){return Math.sqrt(1- --t*t)},EaseInOut:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{EaseIn:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(n||(n=.3),!i||i<1?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)))},EaseOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(n||(n=.3),!i||i<1?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/n)+1)},EaseInOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(n||(n=.3),!i||i<1?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),(t*=2)<1?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)):i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1)}},Back:{EaseIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},EaseOut:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},EaseInOut:function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{EaseIn:function(e){return 1-t.Tween.Easing.Bounce.EaseOut(1-e)},EaseOut:function(t){return(t/=1)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},EaseInOut:function(e){return e<.5?.5*t.Tween.Easing.Bounce.EaseIn(2*e):.5*t.Tween.Easing.Bounce.EaseOut(2*e-1)+.5}}}}).call(window)}).call(e,i(1))},function(t,e,i){var n,s,o,a,a;(function(){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(a){"object"==i(e)&&"undefined"!=typeof t?t.exports=a():(s=[],n=a,o="function"==typeof n?n.apply(e,s):n,!(void 0!==o&&(t.exports=o)))}(function(){return function t(e,i,n){function s(r,l){if(!i[r]){if(!e[r]){var u="function"==typeof a&&a;if(!l&&u)return a(r,!0);if(o)return o(r,!0);var h=new Error("Cannot find module '"+r+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[r]={exports:{}};e[r][0].call(c.exports,function(t){return s(e[r][1][t]||t)},c,c.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof a&&a,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(t,e,i){function n(){}function s(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function o(t,e,i,n,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new s(i,n||t,o),r=u?u+e:e;return t._events[r]?t._events[r].fn?t._events[r]=[t._events[r],a]:t._events[r].push(a):(t._events[r]=a,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function r(){this._events=new n,this._eventsCount=0}var l=Object.prototype.hasOwnProperty,u="~";Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(u=!1)),r.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)l.call(t,e)&&i.push(u?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},r.prototype.listeners=function(t){var e=u?u+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o},r.prototype.listenerCount=function(t){var e=u?u+t:t,i=this._events[e];return i?i.fn?1:i.length:0},r.prototype.emit=function(t,e,i,n,s,o){var a=u?u+t:t;if(!this._events[a])return!1;var r,l,h=this._events[a],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,i),!0;case 4:return h.fn.call(h.context,e,i,n),!0;case 5:return h.fn.call(h.context,e,i,n,s),!0;case 6:return h.fn.call(h.context,e,i,n,s,o),!0}for(l=1,r=new Array(c-1);l<c;l++)r[l-1]=arguments[l];h.fn.apply(h.context,r)}else{var f,p=h.length;for(l=0;l<p;l++)switch(h[l].once&&this.removeListener(t,h[l].fn,void 0,!0),c){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,e);break;case 3:h[l].fn.call(h[l].context,e,i);break;case 4:h[l].fn.call(h[l].context,e,i,n);break;default:if(!r)for(f=1,r=new Array(c-1);f<c;f++)r[f-1]=arguments[f];h[l].fn.apply(h[l].context,r)}}return!0},r.prototype.on=function(t,e,i){return o(this,t,e,i,!1)},r.prototype.once=function(t,e,i){return o(this,t,e,i,!0)},r.prototype.removeListener=function(t,e,i,n){var s=u?u+t:t;if(!this._events[s])return this;if(!e)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||n&&!o.once||i&&o.context!==i||a(this,s);else{for(var r=0,l=[],h=o.length;r<h;r++)(o[r].fn!==e||n&&!o[r].once||i&&o[r].context!==i)&&l.push(o[r]);l.length?this._events[s]=1===l.length?l[0]:l:a(this,s)}return this},r.prototype.removeAllListeners=function(t){var e;return t?(e=u?u+t:t,this._events[e]&&a(this,e)):(this._events=new n,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=u,r.EventEmitter=r,void 0!==e&&(e.exports=r)},{}]},{},[1])(1)})}).call(window)},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.EntityPlayerOne=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)},l=i(3),u=(i(7),i(9));e.EntityPlayerOne=function(e){function i(e,o){n(this,i);var a=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,o,t.KEY.W,t.KEY.S,t.KEY.SPACE));return a.name="Blue",a.angle.x=1,a.type=t.Entity.TYPE.A,a.checkAgainst=t.Entity.TYPE.B,a.colour="#0099FF",a}return o(i,e),a(i,[{key:"draw",value:function(){r(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"draw",this).call(this);var e=t.system.context;e.beginPath(),e.rect(this.pos.x,this.pos.y,this.size.x,this.size.y),e.fillStyle=this.colour,e.fill(),e.lineWidth=3,e.strokeStyle="#000",e.stroke()}},{key:"drawPlayerBar",value:function(e){e.beginPath(),e.fillStyle=l.Player.healthBarColour;var i=Math.normalise(Math.clamp(this.health,1,l.Player.baseHealth),0,l.Player.baseHealth);e.fillRect(0,0,l.Player.statusBarWidth*i,3),e.stroke(),e.beginPath(),e.fillStyle=l.Player.energyBarColour;var n=Math.normalise(Math.clamp(this.energy,1,l.Player.baseEnergy),0,l.Player.baseEnergy);e.fillRect(0,2,l.Player.statusBarWidth*n,3),e.stroke();for(var s=u.Score.convertScoreToIcon(this.score),o=0;o<s.length;o++){var a=l.Player.statusBarWidth+o*l.Player.scoreDisplaySize,r=t.game.spriteMain.getArea(s[o].x,s[o].y,s[o].width,s[o].height);e.drawImage(r,0,0,50,50,a,0,l.Player.scoreDisplaySize,l.Player.scoreDisplaySize)}for(var h=0,c=0;h<this.buffs.length;h++)if(!this.buffs[h].hidden){var f=l.Player.statusBarWidth-++c*l.Player.buffDisplaySize,p=this.buffs[h].icon,d=t.game.spriteMain.getArea(p.x,p.y,p.width,p.height);e.drawImage(d,0,0,50,50,f,6,l.Player.buffDisplaySize,l.Player.buffDisplaySize)}}},{key:"firePositionX",value:function(){return this.pos.x+this.size.x}},{key:"lookDirection",value:function(){return 1}}]),i}(l.Player)}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.EntityPlayerTwo=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(n)},l=i(6),u=i(3),h=(i(7),i(9));e.EntityPlayerTwo=function(e){function i(e,o){n(this,i);var a=s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,o,t.KEY.UP_ARROW,t.KEY.DOWN_ARROW,t.KEY.ENTER));return a.name="Red",a.angle.x=-1,a.type=t.Entity.TYPE.B,a.checkAgainst=t.Entity.TYPE.A,a.colour="#FF0033",a}return o(i,e),a(i,[{key:"draw",value:function(){r(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"draw",this).call(this);var e=t.system.context;e.beginPath(),e.rect(this.pos.x,this.pos.y,this.size.x,this.size.y),e.fillStyle=this.colour,e.fill(),e.lineWidth=3,e.strokeStyle="#000",e.stroke()}},{key:"drawPlayerBar",value:function(e){e.beginPath(),e.fillStyle="#00CC33";var i=200*Math.normalise(Math.clamp(this.health,1,u.Player.baseHealth),0,100);e.fillRect(l.Game.width-i,0,i,3),e.stroke(),e.beginPath(),e.fillStyle="#E68E00";var i=200*Math.normalise(Math.clamp(this.energy,1,u.Player.baseEnergy),0,100);e.fillRect(l.Game.width-i,2,i,3),e.stroke();for(var n=h.Score.convertScoreToIcon(this.score),s=0;s<n.length;s++){var o=l.Game.width-u.Player.statusBarWidth-(n.length-s)*u.Player.scoreDisplaySize,a=t.game.spriteMain.getArea(n[s].x,n[s].y,n[s].width,n[s].height);e.drawImage(a,0,0,50,50,o,0,u.Player.scoreDisplaySize,u.Player.scoreDisplaySize)}for(var r=0,c=0;r<this.buffs.length;r++)if(!this.buffs[r].hidden){var f=l.Game.width-u.Player.statusBarWidth+c++*u.Player.buffDisplaySize,p=this.buffs[r].icon,d=t.game.spriteMain.getArea(p.x,p.y,p.width,p.height);e.drawImage(d,0,0,50,50,f,6,u.Player.buffDisplaySize,u.Player.buffDisplaySize)}}},{key:"firePositionX",value:function(){return this.pos.x}},{key:"lookDirection",value:function(){return-1}}]),i}(u.Player)}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(i){if(Number.prototype.map=function(t,e,i,n){return i+(n-i)*((this-t)/(e-t))},Number.prototype.limit=function(t,e){return Math.min(e,Math.max(t,this))},Number.prototype.round=function(t){return t=Math.pow(10,t||0),Math.round(this*t)/t},Number.prototype.floor=function(){return Math.floor(this)},Number.prototype.ceil=function(){return Math.ceil(this)},Number.prototype.toInt=function(){return 0|this},Number.prototype.toRad=function(){return this/180*Math.PI},Number.prototype.toDeg=function(){return 180*this/Math.PI},String.prototype.toNumber=function(){return parseFloat(this.replace(/[^\d.-]/g,""))||0},Array.prototype.erase=function(t){for(var e=this.length;e--;)this[e]===t&&this.splice(e,1);return this},Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]},Array.prototype.findId=function(t){if(!t)return!1;for(var e=-1,t=String(t).toNumber(),i=0;i<this.length;i++)this[i]instanceof Object&&"number"==typeof this[i].id&&this[i].id==t&&(e=i);return e!=-1&&this[e]},Math.TAU=2*Math.PI,Math.normalise=function(t,e,i){return(t-e)/(i-e)},Math.lerp=function(t,e,i){return(i-e)*t+e},Math.map=function(t,e,i,n,s){return Math.lerp(Math.normalise(t,e,i),n,s)},Math.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},Math.randomFloat=function(t,e){return t+Math.random()*(e-t)},Math.randomInt=function(t,e){return Math.floor(Math.randomFloat(t,e+1))},Function.prototype.bind=Function.prototype.bind||function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},s=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,s.prototype=new n,s},i.ig={game:null,debug:null,version:"1.23",global:i,modules:{},resources:[],ready:!1,baked:!1,nocache:"",ua:{},prefix:i.ImpactPrefix||"",lib:"lib/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(t){return"#"==t.charAt(0)?document.getElementById(t.substr(1)):document.getElementsByTagName(t)},$new:function(t){return document.createElement(t)},copy:function(i){if(!i||"object"!=("undefined"==typeof i?"undefined":e(i))||i instanceof HTMLElement||i instanceof t.Class)return i;if(i instanceof Array){for(var n=[],s=0,o=i.length;s<o;s++)n[s]=t.copy(i[s]);return n}var n={};for(var s in i)n[s]=t.copy(i[s]);return n},merge:function(i,n){for(var s in n){var o=n[s];"object"!=("undefined"==typeof o?"undefined":e(o))||o instanceof HTMLElement||o instanceof t.Class||null===o?i[s]=o:(i[s]&&"object"==e(i[s])||(i[s]=o instanceof Array?[]:{}),t.merge(i[s],o))}return i},ksort:function(t){if(!t||"object"!=("undefined"==typeof t?"undefined":e(t)))return[];var i=[],n=[];for(var s in t)i.push(s);i.sort();for(var s=0;s<i.length;s++)n.push(t[i[s]]);return n},setVendorAttribute:function(t,e,i){var n=e.charAt(0).toUpperCase()+e.substr(1);t[e]=t["ms"+n]=t["moz"+n]=t["webkit"+n]=t["o"+n]=i},getVendorAttribute:function(t,e){var i=e.charAt(0).toUpperCase()+e.substr(1);return t[e]||t["ms"+i]||t["moz"+i]||t["webkit"+i]||t["o"+i]},normalizeVendorAttribute:function(e,i){var n=t.getVendorAttribute(e,i);!e[i]&&n&&(e[i]=n)},getImagePixels:function(e,i,n,s,o){var a=t.$new("canvas");a.width=e.width,a.height=e.height;var r=a.getContext("2d");t.System.SCALE.CRISP(a,r);var l=t.getVendorAttribute(r,"backingStorePixelRatio")||1;t.normalizeVendorAttribute(r,"getImageDataHD");var u=e.width/l,h=e.height/l;return a.width=Math.ceil(u),a.height=Math.ceil(h),r.drawImage(e,0,0,u,h),1===l?r.getImageData(i,n,s,o):r.getImageDataHD(i,n,s,o)},module:function(e){if(t._current)throw"Module '"+t._current.name+"' defines nothing";if(t.modules[e]&&t.modules[e].body)throw"Module '"+e+"' is already defined";return t._current={name:e,requires:[],loaded:!1,body:null},t.modules[e]=t._current,t._loadQueue.push(t._current),t},requires:function(){return t._current.requires=Array.prototype.slice.call(arguments),t},defines:function(e){t._current.body=e,t._current=null,t._initDOMReady()},addResource:function(e){t.resources.push(e)},setNocache:function(e){t.nocache=e?"?"+Date.now():""},log:function(){},assert:function(t,e){},show:function(t,e){},mark:function(t,e){},_loadScript:function(e,i){t.modules[e]={name:e,requires:[],loaded:!1,body:null},t._waitForOnload++;var n=t.prefix+t.lib+e.replace(/\./g,"/")+".js"+t.nocache,s=t.$new("script");s.type="text/javascript",s.src=n,s.onload=function(){t._waitForOnload--,t._execModules()},s.onerror=function(){throw"Failed to load module "+e+" at "+n+" required from "+i},t.$("head")[0].appendChild(s)},_execModules:function(){for(var e=!1,i=0;i<t._loadQueue.length;i++){for(var n=t._loadQueue[i],s=!0,o=0;o<n.requires.length;o++){var a=n.requires[o];t.modules[a]?t.modules[a].loaded||(s=!1):(s=!1,t._loadScript(a,n.name))}s&&n.body&&(t._loadQueue.splice(i,1),n.loaded=!0,n.body(),e=!0,i--)}if(e)t._execModules();else if(!t.baked&&0==t._waitForOnload&&0!=t._loadQueue.length){for(var r=[],i=0;i<t._loadQueue.length;i++){for(var l=[],u=t._loadQueue[i].requires,o=0;o<u.length;o++){var n=t.modules[u[o]];n&&n.loaded||l.push(u[o])}r.push(t._loadQueue[i].name+" (requires: "+l.join(", ")+")")}throw"Unresolved (or circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules or a previous syntax error prevents a module from loading:\n"+r.join("\n")}},_DOMReady:function(){if(!t.modules["dom.ready"].loaded){if(!document.body)return setTimeout(t._DOMReady,13);t.modules["dom.ready"].loaded=!0,t._waitForOnload--,t._execModules()}return 0},_boot:function(){document.location.href.match(/\?nocache/)&&t.setNocache(!0),t.ua.pixelRatio=i.devicePixelRatio||1,t.ua.viewport={width:i.innerWidth,height:i.innerHeight},t.ua.screen={width:i.screen.availWidth*t.ua.pixelRatio,height:i.screen.availHeight*t.ua.pixelRatio},t.ua.iPhone=/iPhone/i.test(navigator.userAgent),t.ua.iPhone4=t.ua.iPhone&&2==t.ua.pixelRatio,t.ua.iPad=/iPad/i.test(navigator.userAgent),t.ua.android=/android/i.test(navigator.userAgent),t.ua.winPhone=/Windows Phone/i.test(navigator.userAgent),t.ua.iOS=t.ua.iPhone||t.ua.iPad,t.ua.mobile=t.ua.iOS||t.ua.android||t.ua.winPhone||/mobile/i.test(navigator.userAgent),t.ua.touchDevice="ontouchstart"in i||i.navigator.msMaxTouchPoints},_initDOMReady:function(){return t.modules["dom.ready"]?void t._execModules():(t._boot(),t.modules["dom.ready"]={requires:[],loaded:!1,body:null},t._waitForOnload++,void("complete"===document.readyState?t._DOMReady():(document.addEventListener("DOMContentLoaded",t._DOMReady,!1),i.addEventListener("load",t._DOMReady,!1))))}},t.normalizeVendorAttribute(i,"requestAnimationFrame"),i.requestAnimationFrame){var n=1,s={};i.ig.setAnimation=function(t,e){var o=n++;s[o]=!0;var a=function n(){s[o]&&(i.requestAnimationFrame(n,e),t())};return i.requestAnimationFrame(a,e),o},i.ig.clearAnimation=function(t){delete s[t]}}else i.ig.setAnimation=function(t,e){return i.setInterval(t,1e3/60)},i.ig.clearAnimation=function(t){i.clearInterval(t)};var o=!1,a=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/,r=0;i.ig.Class=function(){};var l=function(t){var e=this.prototype,i={};for(var n in t)"function"==typeof t[n]&&"function"==typeof e[n]&&a.test(t[n])?(i[n]=e[n],e[n]=function(t,e){return function(){var n=this.parent;this.parent=i[t];var s=e.apply(this,arguments);return this.parent=n,s}}(n,t[n])):e[n]=t[n]};i.ig.Class.extend=function(n){function s(){if(!o){if(this.staticInstantiate){var i=this.staticInstantiate.apply(this,arguments);if(i)return i}for(var n in this)"object"==e(this[n])&&(this[n]=t.copy(this[n]));this.init&&this.init.apply(this,arguments)}return this}var u=this.prototype;o=!0;var h=new this;o=!1;for(var c in n)"function"==typeof n[c]&&"function"==typeof u[c]&&a.test(n[c])?h[c]=function(t,e){return function(){var i=this.parent;this.parent=u[t];var n=e.apply(this,arguments);return this.parent=i,n}}(c,n[c]):h[c]=n[c];return s.prototype=h,s.prototype.constructor=s,s.extend=i.ig.Class.extend,s.inject=l,s.classId=h.classId=++r,s},i.ImpactMixin&&t.merge(t,i.ImpactMixin)}(window),t.module("impact.impact").requires("dom.ready","impact.loader","impact.system","impact.input","impact.sound").defines(function(){t.main=function(e,i,n,s,o,a,r){t.system=new t.System(e,n,s,o,a||1),t.input=new t.Input,t.soundManager=new t.SoundManager,t.music=new t.Music,t.ready=!0;var l=new(r||t.Loader)(i,t.resources);l.load()}})}).call(window)}).call(e,i(1))},function(t,e,i){function n(t){return i(s(t))}function s(t){return o[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var o={"./game/buffs/BuffOfAftershock.js":10,"./game/buffs/BuffOfAgony.js":11,"./game/buffs/BuffOfBombage.js":8,"./game/buffs/BuffOfChains.js":12,"./game/buffs/BuffOfCover.js":13,"./game/buffs/BuffOfDeath.js":14,"./game/buffs/BuffOfDodge.js":15,"./game/buffs/BuffOfExhaustion.js":16,"./game/buffs/BuffOfHealing.js":17,"./game/buffs/BuffOfHell.js":18,"./game/buffs/BuffOfMissiles.js":19,"./game/buffs/BuffOfNetting.js":20,"./game/buffs/BuffOfOvercharge.js":21,"./game/buffs/BuffOfProtection.js":22,"./game/buffs/BuffOfPurgatory.js":23,"./game/buffs/BuffOfSlowness.js":24,"./game/buffs/BuffOfSniperage.js":25,"./game/buffs/BuffOfSpeed.js":26,"./game/buffs/BuffOfStatic.js":27,"./game/core/buff.js":2,"./game/core/bullet.js":4,"./game/core/entity.js":5,"./game/core/images.js":7,"./game/core/player.js":3,"./game/core/score.js":9,"./game/libs/easings.js":28,"./game/libs/eventemitter3/index.js":29,"./game/main.js":6,"./game/players/player1.js":30,"./game/players/player2.js":31,"./impact/animation.js":34,"./impact/background-map.js":35,"./impact/collision-map.js":36,"./impact/debug/debug.js":37,"./impact/debug/entities-panel.js":38,"./impact/debug/graph-panel.js":39,"./impact/debug/maps-panel.js":40,"./impact/debug/menu.js":41,"./impact/entity-pool.js":42,"./impact/entity.js":43,"./impact/font.js":44,"./impact/game.js":45,"./impact/image.js":46,"./impact/impact.js":32,"./impact/input.js":47,"./impact/loader.js":48,"./impact/map.js":49,"./impact/sound.js":50,"./impact/system.js":51,"./impact/timer.js":52};n.keys=function(){return Object.keys(o)},n.resolve=s,t.exports=n,n.id=33},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.animation").requires("impact.timer","impact.image").defines(function(){t.AnimationSheet=t.Class.extend({width:8,height:8,image:null,init:function(e,i,n){this.width=i,this.height=n,e&&(this.image=new t.Image(e))}}),t.Animation=t.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:!1,y:!1},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(e,i,n,s){this.sheet=e,this.pivot={x:e.width/2,y:e.height/2},this.timer=new t.Timer,this.frameTime=i,this.sequence=n,this.stop=!!s,this.tile=this.sequence[0]},rewind:function(){return this.timer.set(),this.loopCount=0,this.frame=0,this.tile=this.sequence[0],this},gotoFrame:function(t){this.timer.set(this.frameTime*-t-1e-4),this.update()},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var t=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(t/this.sequence.length),this.stop&&this.loopCount>0?this.frame=this.sequence.length-1:this.frame=t%this.sequence.length,this.tile=this.sequence[this.frame]},draw:function(e,i){var n=Math.max(this.sheet.width,this.sheet.height);e>t.system.width||i>t.system.height||e+n<0||i+n<0||(1!=this.alpha&&(t.system.context.globalAlpha=this.alpha),0==this.angle?this.sheet.image.drawTile(e,i,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y):(t.system.context.save(),t.system.context.translate(t.system.getDrawPos(e+this.pivot.x),t.system.getDrawPos(i+this.pivot.y)),t.system.context.rotate(this.angle),this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y),t.system.context.restore()),1!=this.alpha&&(t.system.context.globalAlpha=1))}})})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.background-map").requires("impact.map","impact.image").defines(function(){t.BackgroundMap=t.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:!1,tilesetName:"",foreground:!1,enabled:!0,preRender:!1,preRenderedChunks:null,chunkSize:512,debugChunks:!1,anims:{},init:function(t,e,i){this.parent(t,e),this.setTileset(i)},setTileset:function(e){this.tilesetName=e instanceof t.Image?e.path:e,this.tiles=new t.Image(this.tilesetName),this.preRenderedChunks=null},setScreenPos:function(t,e){this.scroll.x=t/this.distance,this.scroll.y=e/this.distance},preRenderMapToChunks:function(){var e=this.width*this.tilesize*t.system.scale,i=this.height*this.tilesize*t.system.scale;this.chunkSize=Math.min(Math.max(e,i),this.chunkSize);var n=Math.ceil(e/this.chunkSize),s=Math.ceil(i/this.chunkSize);this.preRenderedChunks=[];for(var o=0;o<s;o++){this.preRenderedChunks[o]=[];for(var a=0;a<n;a++){var r=a==n-1?e-a*this.chunkSize:this.chunkSize,l=o==s-1?i-o*this.chunkSize:this.chunkSize;this.preRenderedChunks[o][a]=this.preRenderChunk(a,o,r,l)}}},preRenderChunk:function(e,i,n,s){var o=n/this.tilesize/t.system.scale+1,a=s/this.tilesize/t.system.scale+1,r=e*this.chunkSize/t.system.scale%this.tilesize,l=i*this.chunkSize/t.system.scale%this.tilesize,u=Math.floor(e*this.chunkSize/this.tilesize/t.system.scale),h=Math.floor(i*this.chunkSize/this.tilesize/t.system.scale),c=t.$new("canvas");c.width=n,c.height=s,c.retinaResolutionEnabled=!1;var f=c.getContext("2d");t.System.scaleMode(c,f);var p=t.system.context;t.system.context=f;for(var d=0;d<o;d++)for(var y=0;y<a;y++)if(d+u<this.width&&y+h<this.height){var m=this.data[y+h][d+u];m&&this.tiles.drawTile(d*this.tilesize-r,y*this.tilesize-l,m-1,this.tilesize)}return t.system.context=p,c},draw:function(){this.tiles.loaded&&this.enabled&&(this.preRender?this.drawPreRendered():this.drawTiled())},drawPreRendered:function(){this.preRenderedChunks||this.preRenderMapToChunks();var e=t.system.getDrawPos(this.scroll.x),i=t.system.getDrawPos(this.scroll.y);if(this.repeat){var n=this.width*this.tilesize*t.system.scale;e=(e%n+n)%n;var s=this.height*this.tilesize*t.system.scale;i=(i%s+s)%s}var o=Math.max(Math.floor(e/this.chunkSize),0),a=Math.max(Math.floor(i/this.chunkSize),0),r=Math.ceil((e+t.system.realWidth)/this.chunkSize),l=Math.ceil((i+t.system.realHeight)/this.chunkSize),u=this.preRenderedChunks[0].length,h=this.preRenderedChunks.length;this.repeat||(r=Math.min(r,u),l=Math.min(l,h));for(var c=0,f=a;f<l;f++){for(var p=0,d=o;d<r;d++){var y=this.preRenderedChunks[f%h][d%u],m=-e+d*this.chunkSize-p,g=-i+f*this.chunkSize-c;t.system.context.drawImage(y,m,g),t.Image.drawCount++,this.debugChunks&&(t.system.context.strokeStyle="#f0f",t.system.context.strokeRect(m,g,this.chunkSize,this.chunkSize)),this.repeat&&y.width<this.chunkSize&&m+y.width<t.system.realWidth&&(p+=this.chunkSize-y.width,r++)}this.repeat&&y.height<this.chunkSize&&g+y.height<t.system.realHeight&&(c+=this.chunkSize-y.height,l++)}},drawTiled:function(){for(var e=0,i=null,n=(this.scroll.x/this.tilesize).toInt(),s=(this.scroll.y/this.tilesize).toInt(),o=this.scroll.x%this.tilesize,a=this.scroll.y%this.tilesize,r=-o-this.tilesize,l=-a-this.tilesize,u=t.system.width+this.tilesize-o,h=t.system.height+this.tilesize-a,c=-1,f=l;f<h;c++,f+=this.tilesize){var p=c+s;if(p>=this.height||p<0){if(!this.repeat)continue;p=(p%this.height+this.height)%this.height}for(var d=-1,y=r;y<u;d++,y+=this.tilesize){var m=d+n;if(m>=this.width||m<0){if(!this.repeat)continue;m=(m%this.width+this.width)%this.width}(e=this.data[p][m])&&((i=this.anims[e-1])?i.draw(y,f):this.tiles.drawTile(y,f,e-1,this.tilesize))}}}})})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.collision-map").requires("impact.map").defines(function(){t.CollisionMap=t.Map.extend({lastSlope:1,tiledef:null,init:function(e,i,n){this.parent(e,i),this.tiledef=n||t.CollisionMap.defaultTileDef;for(var s in this.tiledef)s|0>this.lastSlope&&(this.lastSlope=0|s)},trace:function(t,e,i,n,s,o){var a={collision:{x:!1,y:!1,slope:!1},pos:{x:t,y:e},tile:{x:0,y:0}},r=Math.ceil(Math.max(Math.abs(i),Math.abs(n))/this.tilesize);if(r>1)for(var l=i/r,u=n/r,h=0;h<r&&(l||u)&&(this._traceStep(a,t,e,l,u,s,o,i,n,h),t=a.pos.x,e=a.pos.y,a.collision.x&&(l=0,i=0),a.collision.y&&(u=0,n=0),!a.collision.slope);h++);else this._traceStep(a,t,e,i,n,s,o,i,n,0);return a},_traceStep:function(t,e,i,n,s,o,a,r,l,u){t.pos.x+=n,t.pos.y+=s;var h=0;if(n){var c=n>0?o:0,f=n<0?this.tilesize:0,p=Math.max(Math.floor(i/this.tilesize),0),d=Math.min(Math.ceil((i+a)/this.tilesize),this.height),y=Math.floor((t.pos.x+c)/this.tilesize),m=Math.floor((e+c)/this.tilesize);if((u>0||y==m||m<0||m>=this.width)&&(m=-1),y>=0&&y<this.width)for(var g=p;g<d&&!(m!=-1&&(h=this.data[g][m],h>1&&h<=this.lastSlope&&this._checkTileDef(t,h,e,i,r,l,o,a,m,g)));g++)if(h=this.data[g][y],
1==h||h>this.lastSlope||h>1&&this._checkTileDef(t,h,e,i,r,l,o,a,y,g)){if(h>1&&h<=this.lastSlope&&t.collision.slope)break;t.collision.x=!0,t.tile.x=h,e=t.pos.x=y*this.tilesize-c+f,r=0;break}}if(s){var v=s>0?a:0,b=s<0?this.tilesize:0,w=Math.max(Math.floor(t.pos.x/this.tilesize),0),E=Math.min(Math.ceil((t.pos.x+o)/this.tilesize),this.width),g=Math.floor((t.pos.y+v)/this.tilesize),_=Math.floor((i+v)/this.tilesize);if((u>0||g==_||_<0||_>=this.height)&&(_=-1),g>=0&&g<this.height)for(var y=w;y<E&&!(_!=-1&&(h=this.data[_][y],h>1&&h<=this.lastSlope&&this._checkTileDef(t,h,e,i,r,l,o,a,y,_)));y++)if(h=this.data[g][y],1==h||h>this.lastSlope||h>1&&this._checkTileDef(t,h,e,i,r,l,o,a,y,g)){if(h>1&&h<=this.lastSlope&&t.collision.slope)break;t.collision.y=!0,t.tile.y=h,t.pos.y=g*this.tilesize-v+b;break}}},_checkTileDef:function(t,e,i,n,s,o,a,r,l,u){var h=this.tiledef[e];if(!h)return!1;var c=(l+h[0])*this.tilesize,f=(u+h[1])*this.tilesize,p=(h[2]-h[0])*this.tilesize,d=(h[3]-h[1])*this.tilesize,y=h[4],m=i+s+(d<0?a:0)-c,g=n+o+(p>0?r:0)-f;if(p*g-d*m>0){if(s*-d+o*p<0)return y;var v=Math.sqrt(p*p+d*d),b=d/v,w=-p/v,E=m*b+g*w,_=b*E,x=w*E;return _*_+x*x>=s*s+o*o?y||p*(g-o)-d*(m-s)<.5:(t.pos.x=i+s-_,t.pos.y=n+o-x,t.collision.slope={x:p,y:d,nx:b,ny:w},!0)}return!1}});var e=.5,i=1/3,n=2/3,s=!0,o=!1;t.CollisionMap.defaultTileDef={5:[0,1,1,n,s],6:[0,n,1,i,s],7:[0,i,1,0,s],3:[0,1,1,e,s],4:[0,e,1,0,s],2:[0,1,1,0,s],10:[e,1,1,0,s],21:[0,1,e,0,s],32:[n,1,1,0,s],43:[i,1,n,0,s],54:[0,1,i,0,s],27:[0,0,1,i,s],28:[0,i,1,n,s],29:[0,n,1,1,s],25:[0,0,1,e,s],26:[0,e,1,1,s],24:[0,0,1,1,s],11:[0,0,e,1,s],22:[e,0,1,1,s],33:[0,0,i,1,s],44:[i,0,n,1,s],55:[n,0,1,1,s],16:[1,i,0,0,s],17:[1,n,0,i,s],18:[1,1,0,n,s],14:[1,e,0,0,s],15:[1,1,0,e,s],13:[1,1,0,0,s],8:[e,1,0,0,s],19:[1,1,e,0,s],30:[i,1,0,0,s],41:[n,1,i,0,s],52:[1,1,n,0,s],38:[1,n,0,1,s],39:[1,i,0,n,s],40:[1,0,0,i,s],36:[1,e,0,1,s],37:[1,0,0,e,s],35:[1,0,0,1,s],9:[1,0,e,1,s],20:[e,0,0,1,s],31:[1,0,n,1,s],42:[n,0,i,1,s],53:[i,0,0,1,s],12:[0,0,1,0,o],23:[1,1,0,1,o],34:[1,0,1,1,o],45:[0,1,0,0,o]},t.CollisionMap.staticNoCollision={trace:function(t,e,i,n){return{collision:{x:!1,y:!1,slope:!1},pos:{x:t+i,y:e+n},tile:{x:0,y:0}}}}})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.debug.debug").requires("impact.debug.entities-panel","impact.debug.maps-panel","impact.debug.graph-panel").defines(function(){})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.module("impact.debug.entities-panel").requires("impact.debug.menu","impact.entity").defines(function(){t.Entity.inject({colors:{names:"#fff",velocities:"#0f0",boxes:"#f00"},draw:function(){if(this.parent(),t.Entity._debugShowBoxes&&(t.system.context.strokeStyle=this.colors.boxes,t.system.context.lineWidth=1,t.system.context.strokeRect(t.system.getDrawPos(this.pos.x.round()-t.game.screen.x)-.5,t.system.getDrawPos(this.pos.y.round()-t.game.screen.y)-.5,this.size.x*t.system.scale,this.size.y*t.system.scale)),t.Entity._debugShowVelocities){var i=this.pos.x+this.size.x/2,n=this.pos.y+this.size.y/2;this._debugDrawLine(this.colors.velocities,i,n,i+this.vel.x,n+this.vel.y)}if(t.Entity._debugShowNames&&(this.name&&(t.system.context.fillStyle=this.colors.names,t.system.context.fillText(this.name,t.system.getDrawPos(this.pos.x-t.game.screen.x),t.system.getDrawPos(this.pos.y-t.game.screen.y))),"object"==e(this.target)))for(var s in this.target){var o=t.game.getEntityByName(this.target[s]);o&&this._debugDrawLine(this.colors.names,this.pos.x+this.size.x/2,this.pos.y+this.size.y/2,o.pos.x+o.size.x/2,o.pos.y+o.size.y/2)}},_debugDrawLine:function(e,i,n,s,o){t.system.context.strokeStyle=e,t.system.context.lineWidth=1,t.system.context.beginPath(),t.system.context.moveTo(t.system.getDrawPos(i-t.game.screen.x),t.system.getDrawPos(n-t.game.screen.y)),t.system.context.lineTo(t.system.getDrawPos(s-t.game.screen.x),t.system.getDrawPos(o-t.game.screen.y)),t.system.context.stroke(),t.system.context.closePath()}}),t.Entity._debugEnableChecks=!0,t.Entity._debugShowBoxes=!1,t.Entity._debugShowVelocities=!1,t.Entity._debugShowNames=!1,t.Entity.oldCheckPair=t.Entity.checkPair,t.Entity.checkPair=function(e,i){t.Entity._debugEnableChecks&&t.Entity.oldCheckPair(e,i)},t.debug.addPanel({type:t.DebugPanel,name:"entities",label:"Entities",options:[{name:"Checks & Collisions",object:t.Entity,property:"_debugEnableChecks"},{name:"Show Collision Boxes",object:t.Entity,property:"_debugShowBoxes"},{name:"Show Velocities",object:t.Entity,property:"_debugShowVelocities"},{name:"Show Names & Targets",object:t.Entity,property:"_debugShowNames"}]})})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.debug.graph-panel").requires("impact.debug.menu","impact.system","impact.game","impact.image").defines(function(){t.Game.inject({draw:function(){t.graph.beginClock("draw"),this.parent(),t.graph.endClock("draw")},update:function(){t.graph.beginClock("update"),this.parent(),t.graph.endClock("update")},checkEntities:function(){t.graph.beginClock("checks"),this.parent(),t.graph.endClock("checks")}}),t.DebugGraphPanel=t.DebugPanel.extend({clocks:{},marks:[],textY:0,height:128,ms:64,timeBeforeRun:0,init:function(e,i){this.parent(e,i),this.mark16ms=(this.height-this.height/this.ms*16).round(),this.mark33ms=(this.height-this.height/this.ms*33).round(),this.msHeight=this.height/this.ms,this.graph=t.$new("canvas"),this.graph.width=window.innerWidth,this.graph.height=this.height,this.container.appendChild(this.graph),this.ctx=this.graph.getContext("2d"),this.ctx.fillStyle="#444",this.ctx.fillRect(0,this.mark16ms,this.graph.width,1),this.ctx.fillRect(0,this.mark33ms,this.graph.width,1),this.addGraphMark("16ms",this.mark16ms),this.addGraphMark("33ms",this.mark33ms),this.addClock("draw","Draw","#13baff"),this.addClock("update","Entity Update","#bb0fff"),this.addClock("checks","Entity Checks & Collisions","#a2e908"),this.addClock("lag","System Lag","#f26900"),t.mark=this.mark.bind(this),t.graph=this},addGraphMark:function(e,i){var n=t.$new("span");n.className="ig_debug_graph_mark",n.textContent=e,n.style.top=i.round()+"px",this.container.appendChild(n)},addClock:function(e,i,n){var s=t.$new("span");s.className="ig_debug_legend_color",s.style.backgroundColor=n;var o=t.$new("span");o.className="ig_debug_legend_number",o.appendChild(document.createTextNode("0"));var a=t.$new("span");a.className="ig_debug_legend",a.appendChild(s),a.appendChild(document.createTextNode(i+" (")),a.appendChild(o),a.appendChild(document.createTextNode("ms)")),this.container.appendChild(a),this.clocks[e]={description:i,color:n,current:0,start:Date.now(),avg:0,html:o}},beginClock:function(t,e){this.clocks[t].start=Date.now()+(e||0)},endClock:function(t){var e=this.clocks[t];e.current=Math.round(Date.now()-e.start),e.avg=.8*e.avg+.2*e.current},mark:function(t,e){this.active&&this.marks.push({msg:t,color:e||"#fff"})},beforeRun:function(){this.endClock("lag"),this.timeBeforeRun=Date.now()},afterRun:function(){var e=Date.now()-this.timeBeforeRun,i=1e3/t.system.fps-e;this.beginClock("lag",Math.max(i,0));var n=this.graph.width-1,s=this.height;this.ctx.drawImage(this.graph,-1,0),this.ctx.fillStyle="#000",this.ctx.fillRect(n,0,1,this.height),this.ctx.fillStyle="#444",this.ctx.fillRect(n,this.mark16ms,1,1),this.ctx.fillStyle="#444",this.ctx.fillRect(n,this.mark33ms,1,1);for(var o in this.clocks){var a=this.clocks[o];if(a.html.textContent=a.avg.toFixed(2),a.color&&a.current>0){this.ctx.fillStyle=a.color;var r=a.current*this.msHeight;s-=r,this.ctx.fillRect(n,s,1,r),a.current=0}}this.ctx.textAlign="right",this.ctx.textBaseline="top",this.ctx.globalAlpha=.5;for(var l=0;l<this.marks.length;l++){var u=this.marks[l];this.ctx.fillStyle=u.color,this.ctx.fillRect(n,0,1,this.height),u.msg&&(this.ctx.fillText(u.msg,n-1,this.textY),this.textY=(this.textY+8)%32)}this.ctx.globalAlpha=1,this.marks=[]}}),t.debug.addPanel({type:t.DebugGraphPanel,name:"graph",label:"Performance"})})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.debug.maps-panel").requires("impact.debug.menu","impact.game","impact.background-map").defines(function(){t.Game.inject({loadLevel:function(e){this.parent(e),t.debug.panels.maps.load(this)}}),t.DebugMapsPanel=t.DebugPanel.extend({maps:[],mapScreens:[],init:function(t,e){this.parent(t,e),this.load()},load:function(e){if(this.options=[],this.panels=[],!e||!e.backgroundMaps.length)return void(this.container.innerHTML="<em>No Maps Loaded</em>");this.maps=e.backgroundMaps,this.mapScreens=[],this.container.innerHTML="";for(var i=0;i<this.maps.length;i++){var n=this.maps[i],s=new t.DebugPanel(i,"Layer "+i),o=new t.$new("strong");o.textContent=i+": "+n.tiles.path,s.container.appendChild(o),s.addOption(new t.DebugOption("Enabled",n,"enabled")),s.addOption(new t.DebugOption("Pre Rendered",n,"preRender")),s.addOption(new t.DebugOption("Show Chunks",n,"debugChunks")),this.generateMiniMap(s,n,i),this.addPanel(s)}},generateMiniMap:function(e,i,n){var s=t.system.scale,o=t.$new("canvas"),a=o.getContext("2d"),r=i.tiles.width*s,l=i.tiles.height*s,u=r/i.tilesize,h=l/i.tilesize;o.width=u,o.height=h,a.drawImage(i.tiles.data,0,0,r,l,0,0,u,h);var c=t.$new("canvas");c.width=i.width*s,c.height=i.height*s;var f=c.getContext("2d");t.game.clearColor&&(f.fillStyle=t.game.clearColor,f.fillRect(0,0,r,l));for(var p=0,d=0;d<i.width;d++)for(var y=0;y<i.height;y++)(p=i.data[y][d])&&f.drawImage(o,Math.floor((p-1)*s%u),Math.floor((p-1)*s/u)*s,s,s,d*s,y*s,s,s);var m=t.$new("div");m.className="ig_debug_map_container",m.style.width=i.width*s+"px",m.style.height=i.height*s+"px";var g=t.$new("div");g.className="ig_debug_map_screen",g.style.width=t.system.width/i.tilesize*s-2+"px",g.style.height=t.system.height/i.tilesize*s-2+"px",this.mapScreens[n]=g,m.appendChild(c),m.appendChild(g),e.container.appendChild(m)},afterRun:function(){for(var e=t.system.scale,i=0;i<this.maps.length;i++){var n=this.maps[i],s=this.mapScreens[i];if(n&&s){var o=n.scroll.x/n.tilesize,a=n.scroll.y/n.tilesize;n.repeat&&(o%=n.width,a%=n.height),s.style.left=o*e+"px",s.style.top=a*e+"px"}}}}),t.debug.addPanel({type:t.DebugMapsPanel,name:"maps",label:"Background Maps"})})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.debug.menu").requires("dom.ready","impact.system").defines(function(){t.System.inject({run:function(){t.debug.beforeRun(),this.parent(),t.debug.afterRun()},setGameNow:function(e){this.parent(e),t.debug.ready()}}),t.Debug=t.Class.extend({options:{},panels:{},numbers:{},container:null,panelMenu:null,activePanel:null,debugTime:0,debugTickAvg:.016,debugRealTime:Date.now(),init:function(){var e=t.$new("link");e.rel="stylesheet",e.type="text/css",e.href=t.prefix+"lib/impact/debug/debug.css",t.$("body")[0].appendChild(e),this.container=t.$new("div"),this.container.className="ig_debug",t.$("body")[0].appendChild(this.container),this.panelMenu=t.$new("div"),this.panelMenu.innerHTML='<div class="ig_debug_head">Impact.Debug:</div>',this.panelMenu.className="ig_debug_panel_menu",this.container.appendChild(this.panelMenu),this.numberContainer=t.$new("div"),this.numberContainer.className="ig_debug_stats",this.panelMenu.appendChild(this.numberContainer),window.console&&window.console.log&&window.console.assert&&(t.log=console.log.bind?console.log.bind(console):console.log,t.assert=console.assert.bind?console.assert.bind(console):console.assert),t.show=this.showNumber.bind(this)},addNumber:function(e,i){var n=t.$new("span");this.numberContainer.appendChild(n),this.numberContainer.appendChild(document.createTextNode(e)),this.numbers[e]=n},showNumber:function(t,e,i){this.numbers[t]||this.addNumber(t,i),this.numbers[t].textContent=e},addPanel:function(e){var i=new e.type(e.name,e.label);if(e.options)for(var n=0;n<e.options.length;n++){var s=e.options[n];i.addOption(new t.DebugOption(s.name,s.object,s.property))}this.panels[i.name]=i,i.container.style.display="none",this.container.appendChild(i.container);var o=t.$new("div");o.className="ig_debug_menu_item",o.textContent=i.label,o.addEventListener("click",function(t){this.togglePanel(i)}.bind(this),!1),i.menuItem=o;for(var a=!1,n=1;n<this.panelMenu.childNodes.length;n++){var r=this.panelMenu.childNodes[n];if(r.textContent>i.label){this.panelMenu.insertBefore(o,r),a=!0;break}}a||this.panelMenu.appendChild(o)},showPanel:function(t){this.togglePanel(this.panels[t])},togglePanel:function(t){t!=this.activePanel&&this.activePanel&&(this.activePanel.toggle(!1),this.activePanel.menuItem.className="ig_debug_menu_item",this.activePanel=null);var e=t.container.style.display,i="block"!=e;t.toggle(i),t.menuItem.className="ig_debug_menu_item"+(i?" active":""),i&&(this.activePanel=t)},ready:function(){for(var t in this.panels)this.panels[t].ready()},beforeRun:function(){var t=Date.now();this.debugTickAvg=.8*this.debugTickAvg+.2*(t-this.debugRealTime),this.debugRealTime=t,this.activePanel&&this.activePanel.beforeRun()},afterRun:function(){var e=Date.now()-this.debugRealTime;1e3/t.system.fps-e;this.debugTime=.8*this.debugTime+.2*e,this.activePanel&&this.activePanel.afterRun(),this.showNumber("ms",this.debugTime.toFixed(2)),this.showNumber("fps",Math.round(1e3/this.debugTickAvg)),this.showNumber("draws",t.Image.drawCount),t.game&&t.game.entities&&this.showNumber("entities",t.game.entities.length),t.Image.drawCount=0}}),t.DebugPanel=t.Class.extend({active:!1,container:null,options:[],panels:[],label:"",name:"",init:function(e,i){this.name=e,this.label=i,this.container=t.$new("div"),this.container.className="ig_debug_panel "+this.name},toggle:function(t){this.active=t,this.container.style.display=t?"block":"none"},addPanel:function(t){this.panels.push(t),this.container.appendChild(t.container)},addOption:function(t){this.options.push(t),this.container.appendChild(t.container)},ready:function(){},beforeRun:function(){},afterRun:function(){}}),t.DebugOption=t.Class.extend({name:"",labelName:"",className:"ig_debug_option",label:null,mark:null,container:null,active:!1,colors:{enabled:"#fff",disabled:"#444"},init:function(e,i,n){this.name=e,this.object=i,this.property=n,this.active=this.object[this.property],this.container=t.$new("div"),this.container.className="ig_debug_option",this.label=t.$new("span"),this.label.className="ig_debug_label",this.label.textContent=this.name,this.mark=t.$new("span"),this.mark.className="ig_debug_label_mark",this.container.appendChild(this.mark),this.container.appendChild(this.label),this.container.addEventListener("click",this.click.bind(this),!1),this.setLabel()},setLabel:function(){this.mark.style.backgroundColor=this.active?this.colors.enabled:this.colors.disabled},click:function(t){return this.active=!this.active,this.object[this.property]=this.active,this.setLabel(),t.stopPropagation(),t.preventDefault(),!1}}),t.debug=new t.Debug})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.entity-pool").requires("impact.game").defines(function(){t.EntityPool={pools:{},mixin:{staticInstantiate:function(e,i,n){return t.EntityPool.getFromPool(this.classId,e,i,n)},erase:function(){t.EntityPool.putInPool(this)}},enableFor:function(t){t.inject(this.mixin)},getFromPool:function(t,e,i,n){var s=this.pools[t];if(!s||!s.length)return null;var o=s.pop();return o.reset(e,i,n),o},putInPool:function(t){this.pools[t.classId]?this.pools[t.classId].push(t):this.pools[t.classId]=[t]},drainPool:function(t){delete this.pools[t]},drainAllPools:function(){this.pools={}}},t.Game.inject({loadLevel:function(e){t.EntityPool.drainAllPools(),this.parent(e)}})})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.entity").requires("impact.animation","impact.impact").defines(function(){t.Entity=t.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:!1,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:!1,slopeStanding:{min:44..toRad(),max:136..toRad()},init:function(e,i,n){this.id=++t.Entity._lastId,this.pos.x=this.last.x=e,this.pos.y=this.last.y=i,t.merge(this,n)},reset:function(e,i,n){var s=this.constructor.prototype;this.pos.x=e,this.pos.y=i,this.last.x=e,this.last.y=i,this.vel.x=s.vel.x,this.vel.y=s.vel.y,this.accel.x=s.accel.x,this.accel.y=s.accel.y,this.health=s.health,this._killed=s._killed,this.standing=s.standing,this.type=s.type,this.checkAgainst=s.checkAgainst,this.collides=s.collides,t.merge(this,n)},addAnim:function(e,i,n,s){if(!this.animSheet)throw"No animSheet to add the animation "+e+" to.";var o=new t.Animation(this.animSheet,i,n,s);return this.anims[e]=o,this.currentAnim||(this.currentAnim=o),o},update:function(){this.last.x=this.pos.x,this.last.y=this.pos.y,this.vel.y+=t.game.gravity*t.system.tick*this.gravityFactor,this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x),this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var e=this.vel.x*t.system.tick,i=this.vel.y*t.system.tick,n=t.game.collisionMap.trace(this.pos.x,this.pos.y,e,i,this.size.x,this.size.y);this.handleMovementTrace(n),this.currentAnim&&this.currentAnim.update()},getNewVelocity:function(e,i,n,s){if(i)return(e+i*t.system.tick).limit(-s,s);if(n){var o=n*t.system.tick;return e-o>0?e-o:e+o<0?e+o:0}return e.limit(-s,s)},handleMovementTrace:function(t){if(this.standing=!1,t.collision.y&&(this.bounciness>0&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(this.vel.y>0&&(this.standing=!0),this.vel.y=0)),t.collision.x&&(this.bounciness>0&&Math.abs(this.vel.x)>this.minBounceVelocity?this.vel.x*=-this.bounciness:this.vel.x=0),t.collision.slope){var e=t.collision.slope;if(this.bounciness>0){var i=this.vel.x*e.nx+this.vel.y*e.ny;this.vel.x=(this.vel.x-e.nx*i*2)*this.bounciness,this.vel.y=(this.vel.y-e.ny*i*2)*this.bounciness}else{var n=e.x*e.x+e.y*e.y,s=(this.vel.x*e.x+this.vel.y*e.y)/n;this.vel.x=e.x*s,this.vel.y=e.y*s;var o=Math.atan2(e.x,e.y);o>this.slopeStanding.min&&o<this.slopeStanding.max&&(this.standing=!0)}}this.pos=t.pos},draw:function(){this.currentAnim&&this.currentAnim.draw(this.pos.x-this.offset.x-t.game._rscreen.x,this.pos.y-this.offset.y-t.game._rscreen.y)},kill:function(){t.game.removeEntity(this)},receiveDamage:function(t,e){this.health-=t,this.health<=0&&this.kill()},touches:function(t){return!(this.pos.x>=t.pos.x+t.size.x||this.pos.x+this.size.x<=t.pos.x||this.pos.y>=t.pos.y+t.size.y||this.pos.y+this.size.y<=t.pos.y)},distanceTo:function(t){var e=this.pos.x+this.size.x/2-(t.pos.x+t.size.x/2),i=this.pos.y+this.size.y/2-(t.pos.y+t.size.y/2);return Math.sqrt(e*e+i*i)},angleTo:function(t){return Math.atan2(t.pos.y+t.size.y/2-(this.pos.y+this.size.y/2),t.pos.x+t.size.x/2-(this.pos.x+this.size.x/2))},check:function(t){},collideWith:function(t,e){},ready:function(){},erase:function(){}}),t.Entity._lastId=0,t.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8},t.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3},t.Entity.checkPair=function(e,i){e.checkAgainst&i.type&&e.check(i),i.checkAgainst&e.type&&i.check(e),e.collides&&i.collides&&e.collides+i.collides>t.Entity.COLLIDES.ACTIVE&&t.Entity.solveCollision(e,i)},t.Entity.solveCollision=function(e,i){var n=null;e.collides==t.Entity.COLLIDES.LITE||i.collides==t.Entity.COLLIDES.FIXED?n=e:i.collides!=t.Entity.COLLIDES.LITE&&e.collides!=t.Entity.COLLIDES.FIXED||(n=i),e.last.x+e.size.x>i.last.x&&e.last.x<i.last.x+i.size.x?(e.last.y<i.last.y?t.Entity.seperateOnYAxis(e,i,n):t.Entity.seperateOnYAxis(i,e,n),e.collideWith(i,"y"),i.collideWith(e,"y")):e.last.y+e.size.y>i.last.y&&e.last.y<i.last.y+i.size.y&&(e.last.x<i.last.x?t.Entity.seperateOnXAxis(e,i,n):t.Entity.seperateOnXAxis(i,e,n),e.collideWith(i,"x"),i.collideWith(e,"x"))},t.Entity.seperateOnXAxis=function(e,i,n){var s=e.pos.x+e.size.x-i.pos.x;if(n){var o=e===n?i:e;n.vel.x=-n.vel.x*n.bounciness+o.vel.x;var a=t.game.collisionMap.trace(n.pos.x,n.pos.y,n==e?-s:s,0,n.size.x,n.size.y);n.pos.x=a.pos.x}else{var r=(e.vel.x-i.vel.x)/2;e.vel.x=-r,i.vel.x=r;var l=t.game.collisionMap.trace(e.pos.x,e.pos.y,-s/2,0,e.size.x,e.size.y);e.pos.x=Math.floor(l.pos.x);var u=t.game.collisionMap.trace(i.pos.x,i.pos.y,s/2,0,i.size.x,i.size.y);i.pos.x=Math.ceil(u.pos.x)}},t.Entity.seperateOnYAxis=function(e,i,n){var s=e.pos.y+e.size.y-i.pos.y;if(n){var o=e===n?i:e;n.vel.y=-n.vel.y*n.bounciness+o.vel.y;var a=0;n==e&&Math.abs(n.vel.y-o.vel.y)<n.minBounceVelocity&&(n.standing=!0,a=o.vel.x*t.system.tick);var r=t.game.collisionMap.trace(n.pos.x,n.pos.y,a,n==e?-s:s,n.size.x,n.size.y);n.pos.y=r.pos.y,n.pos.x=r.pos.x}else if(t.game.gravity&&(i.standing||e.vel.y>0)){var l=t.game.collisionMap.trace(e.pos.x,e.pos.y,0,-(e.pos.y+e.size.y-i.pos.y),e.size.x,e.size.y);e.pos.y=l.pos.y,e.bounciness>0&&e.vel.y>e.minBounceVelocity?e.vel.y*=-e.bounciness:(e.standing=!0,e.vel.y=0)}else{var u=(e.vel.y-i.vel.y)/2;e.vel.y=-u,i.vel.y=u;var a=i.vel.x*t.system.tick,l=t.game.collisionMap.trace(e.pos.x,e.pos.y,a,-s/2,e.size.x,e.size.y);e.pos.y=l.pos.y;var h=t.game.collisionMap.trace(i.pos.x,i.pos.y,0,s/2,i.size.x,i.size.y);i.pos.y=h.pos.y}}})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.font").requires("impact.image").defines(function(){t.Font=t.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(t){this._loadMetrics(this.data),this.parent(t)},widthForString:function(t){if(t.indexOf("\n")!==-1){for(var e=t.split("\n"),i=0,n=0;n<e.length;n++)i=Math.max(i,this._widthForLine(e[n]));return i}return this._widthForLine(t)},_widthForLine:function(t){for(var e=0,i=0;i<t.length;i++)e+=this.widthMap[t.charCodeAt(i)-this.firstChar]+this.letterSpacing;return e},heightForString:function(t){return t.split("\n").length*(this.height+this.lineSpacing)},draw:function(e,i,n,s){if("string"!=typeof e&&(e=e.toString()),e.indexOf("\n")===-1){if(s==t.Font.ALIGN.RIGHT||s==t.Font.ALIGN.CENTER){var o=this._widthForLine(e);i-=s==t.Font.ALIGN.CENTER?o/2:o}1!==this.alpha&&(t.system.context.globalAlpha=this.alpha);for(var a=0;a<e.length;a++){var r=e.charCodeAt(a);i+=this._drawChar(r-this.firstChar,i,n)}1!==this.alpha&&(t.system.context.globalAlpha=1),t.Image.drawCount+=e.length}else for(var l=e.split("\n"),u=this.height+this.lineSpacing,a=0;a<l.length;a++)this.draw(l[a],i,n+a*u,s)},_drawChar:function(e,i,n){if(!this.loaded||e<0||e>=this.indices.length)return 0;var s=t.system.scale,o=this.indices[e]*s,a=0,r=this.widthMap[e]*s,l=(this.height-2)*s;return t.system.context.drawImage(this.data,o,a,r,l,t.system.getDrawPos(i),t.system.getDrawPos(n),r,l),this.widthMap[e]+this.letterSpacing},_loadMetrics:function(e){this.height=e.height-1,this.widthMap=[],this.indices=[];for(var i=t.getImagePixels(e,0,e.height-1,e.width,1),n=0,s=0,o=0;o<e.width;o++){var a=4*o+3;i.data[a]>127?s++:i.data[a]<128&&s&&(this.widthMap.push(s),this.indices.push(o-s),n++,s=0)}this.widthMap.push(s),this.indices.push(o-s)}}),t.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2}})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.game").requires("impact.impact","impact.entity","impact.collision-map","impact.background-map").defines(function(){t.Game=t.Class.extend({clearColor:"#000000",gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:t.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:!1,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:!1,staticInstantiate:function(){return this.sortBy=this.sortBy||t.Game.SORT.Z_INDEX,t.game=this,null},loadLevel:function(e){this.screen={x:0,y:0},this.entities=[],this.namedEntities={};for(var i=0;i<e.entities.length;i++){var n=e.entities[i];this.spawnEntity(n.type,n.x,n.y,n.settings)}this.sortEntities(),this.collisionMap=t.CollisionMap.staticNoCollision,this.backgroundMaps=[];for(var i=0;i<e.layer.length;i++){var s=e.layer[i];if("collision"==s.name)this.collisionMap=new t.CollisionMap(s.tilesize,s.data);else{var o=new t.BackgroundMap(s.tilesize,s.data,s.tilesetName);o.anims=this.backgroundAnims[s.tilesetName]||{},o.repeat=s.repeat,o.distance=s.distance,o.foreground=!!s.foreground,o.preRender=!!s.preRender,o.name=s.name,this.backgroundMaps.push(o)}}for(var i=0;i<this.entities.length;i++)this.entities[i].ready()},loadLevelDeferred:function(t){this._levelToLoad=t},getMapByName:function(t){if("collision"==t)return this.collisionMap;for(var e=0;e<this.backgroundMaps.length;e++)if(this.backgroundMaps[e].name==t)return this.backgroundMaps[e];return null},getEntityByName:function(t){return this.namedEntities[t]},getEntitiesByType:function(e){for(var i="string"==typeof e?t.global[e]:e,n=[],s=0;s<this.entities.length;s++){var o=this.entities[s];o instanceof i&&!o._killed&&n.push(o)}return n},spawnEntity:function(e,i,n,s){var o="string"==typeof e?t.global[e]:e;if(!o)throw"Can't spawn entity of type "+e;var a=new o(i,n,s||{});return this.entities.push(a),a.name&&(this.namedEntities[a.name]=a),a},sortEntities:function(){this.entities.sort(this.sortBy)},sortEntitiesDeferred:function(){this._doSortEntities=!0},removeEntity:function(e){e.name&&delete this.namedEntities[e.name],e._killed=!0,e.type=t.Entity.TYPE.NONE,e.checkAgainst=t.Entity.TYPE.NONE,e.collides=t.Entity.COLLIDES.NEVER,this._deferredKill.push(e)},run:function(){this.update(),this.draw()},update:function(){this._levelToLoad&&(this.loadLevel(this._levelToLoad),this._levelToLoad=null),this.updateEntities(),this.checkEntities();for(var t=0;t<this._deferredKill.length;t++)this._deferredKill[t].erase(),this.entities.erase(this._deferredKill[t]);this._deferredKill=[],(this._doSortEntities||this.autoSort)&&(this.sortEntities(),this._doSortEntities=!1);for(var e in this.backgroundAnims){var i=this.backgroundAnims[e];for(var n in i)i[n].update()}},updateEntities:function(){for(var t=0;t<this.entities.length;t++){var e=this.entities[t];e._killed||e.update()}},draw:function(){this.clearColor&&t.system.clear(this.clearColor),this._rscreen.x=t.system.getDrawPos(this.screen.x)/t.system.scale,this._rscreen.y=t.system.getDrawPos(this.screen.y)/t.system.scale;var e;for(e=0;e<this.backgroundMaps.length;e++){var i=this.backgroundMaps[e];if(i.foreground)break;i.setScreenPos(this.screen.x,this.screen.y),i.draw()}for(this.drawEntities(),e;e<this.backgroundMaps.length;e++){var i=this.backgroundMaps[e];i.setScreenPos(this.screen.x,this.screen.y),i.draw()}},drawEntities:function(){for(var t=0;t<this.entities.length;t++)this.entities[t].draw()},checkEntities:function(){for(var e={},i=0;i<this.entities.length;i++){var n=this.entities[i];if(n.type!=t.Entity.TYPE.NONE||n.checkAgainst!=t.Entity.TYPE.NONE||n.collides!=t.Entity.COLLIDES.NEVER)for(var s={},o=Math.floor(n.pos.x/this.cellSize),a=Math.floor(n.pos.y/this.cellSize),r=Math.floor((n.pos.x+n.size.x)/this.cellSize)+1,l=Math.floor((n.pos.y+n.size.y)/this.cellSize)+1,u=o;u<r;u++)for(var h=a;h<l;h++)if(e[u])if(e[u][h]){for(var c=e[u][h],f=0;f<c.length;f++)n.touches(c[f])&&!s[c[f].id]&&(s[c[f].id]=!0,t.Entity.checkPair(n,c[f]));c.push(n)}else e[u][h]=[n];else e[u]={},e[u][h]=[n]}}}),t.Game.SORT={Z_INDEX:function(t,e){return t.zIndex-e.zIndex},POS_X:function(t,e){return t.pos.x+t.size.x-(e.pos.x+e.size.x)},POS_Y:function(t,e){return t.pos.y+t.size.y-(e.pos.y+e.size.y)}}})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.image").defines(function(){t.Image=t.Class.extend({data:null,width:0,height:0,loaded:!1,failed:!1,loadCallback:null,path:"",staticInstantiate:function(e){return t.Image.cache[e]||null},init:function(t){this.path=t,this.load()},load:function(e){return this.loaded?void(e&&e(this.path,!0)):(!this.loaded&&t.ready?(this.loadCallback=e||null,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=t.prefix+this.path+t.nocache):t.addResource(this),void(t.Image.cache[this.path]=this))},reload:function(){this.loaded=!1,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.src=this.path+"?"+Date.now()},onload:function(e){this.width=this.data.width,this.height=this.data.height,this.loaded=!0,1!=t.system.scale&&this.resize(t.system.scale),this.loadCallback&&this.loadCallback(this.path,!0)},onerror:function(t){this.failed=!0,this.loadCallback&&this.loadCallback(this.path,!1)},resize:function(e){var i=t.getImagePixels(this.data,0,0,this.width,this.height),n=this.width*e,s=this.height*e,o=t.$new("canvas");o.width=n,o.height=s;for(var a=o.getContext("2d"),r=a.getImageData(0,0,n,s),l=0;l<s;l++)for(var u=0;u<n;u++){var h=4*(Math.floor(l/e)*this.width+Math.floor(u/e)),c=4*(l*n+u);r.data[c]=i.data[h],r.data[c+1]=i.data[h+1],r.data[c+2]=i.data[h+2],r.data[c+3]=i.data[h+3]}a.putImageData(r,0,0),this.data=o},draw:function(e,i,n,s,o,a){if(this.loaded){var r=t.system.scale;n=n?n*r:0,s=s?s*r:0,o=(o?o:this.width)*r,a=(a?a:this.height)*r,t.system.context.drawImage(this.data,n,s,o,a,t.system.getDrawPos(e),t.system.getDrawPos(i),o,a),t.Image.drawCount++}},drawTile:function(e,i,n,s,o,a,r){if(o=o?o:s,!(!this.loaded||s>this.width||o>this.height)){var l=t.system.scale,u=Math.floor(s*l),h=Math.floor(o*l),c=a?-1:1,f=r?-1:1;(a||r)&&(t.system.context.save(),t.system.context.scale(c,f)),t.system.context.drawImage(this.data,Math.floor(n*s)%this.width*l,Math.floor(n*s/this.width)*o*l,u,h,t.system.getDrawPos(e)*c-(a?u:0),t.system.getDrawPos(i)*f-(r?h:0),u,h),(a||r)&&t.system.context.restore(),t.Image.drawCount++}}}),t.Image.drawCount=0,t.Image.cache={},t.Image.reloadCache=function(){for(var e in t.Image.cache)t.Image.cache[e].reload()}})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.input").defines(function(){t.KEY={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190},t.Input=t.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:!1,isUsingKeyboard:!1,isUsingAccelerometer:!1,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=!0;var e=this.mousewheel.bind(this);t.system.canvas.addEventListener("mousewheel",e,!1),t.system.canvas.addEventListener("DOMMouseScroll",e,!1),t.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1),t.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1),t.system.canvas.addEventListener("mouseup",this.keyup.bind(this),!1),t.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1),t.ua.touchDevice&&(t.system.canvas.addEventListener("touchstart",this.keydown.bind(this),!1),t.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),t.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),t.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),t.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),
t.system.canvas.addEventListener("MSPointerMove",this.mousemove.bind(this),!1),t.system.canvas.style.msTouchAction="none")}},initKeyboard:function(){this.isUsingKeyboard||(this.isUsingKeyboard=!0,window.addEventListener("keydown",this.keydown.bind(this),!1),window.addEventListener("keyup",this.keyup.bind(this),!1))},initAccelerometer:function(){this.isUsingAccelerometer||window.addEventListener("devicemotion",this.devicemotion.bind(this),!1)},mousewheel:function(e){var i=e.wheelDelta?e.wheelDelta:e.detail*-1,n=i>0?t.KEY.MWHEEL_UP:t.KEY.MWHEEL_DOWN,s=this.bindings[n];s&&(this.actions[s]=!0,this.presses[s]=!0,this.delayedKeyup[s]=!0,e.stopPropagation(),e.preventDefault())},mousemove:function(e){var i=parseInt(t.system.canvas.offsetWidth)||t.system.realWidth,n=t.system.scale*(i/t.system.realWidth),s={left:0,top:0};t.system.canvas.getBoundingClientRect&&(s=t.system.canvas.getBoundingClientRect());var o=e.touches?e.touches[0]:e;this.mouse.x=(o.clientX-s.left)/n,this.mouse.y=(o.clientY-s.top)/n},contextmenu:function(e){this.bindings[t.KEY.MOUSE2]&&(e.stopPropagation(),e.preventDefault())},keydown:function(e){var i=e.target.tagName;if("INPUT"!=i&&"TEXTAREA"!=i){var n="keydown"==e.type?e.keyCode:2==e.button?t.KEY.MOUSE2:t.KEY.MOUSE1;"touchstart"!=e.type&&"mousedown"!=e.type||this.mousemove(e);var s=this.bindings[n];s&&(this.actions[s]=!0,this.locks[s]||(this.presses[s]=!0,this.locks[s]=!0),e.stopPropagation(),e.preventDefault())}},keyup:function(e){var i=e.target.tagName;if("INPUT"!=i&&"TEXTAREA"!=i){var n="keyup"==e.type?e.keyCode:2==e.button?t.KEY.MOUSE2:t.KEY.MOUSE1,s=this.bindings[n];s&&(this.delayedKeyup[s]=!0,e.stopPropagation(),e.preventDefault())}},devicemotion:function(t){this.accel=t.accelerationIncludingGravity},bind:function(t,e){t<0?this.initMouse():t>0&&this.initKeyboard(),this.bindings[t]=e},bindTouch:function(e,i){var n=t.$(e),s=this;n.addEventListener("touchstart",function(t){s.touchStart(t,i)},!1),n.addEventListener("touchend",function(t){s.touchEnd(t,i)},!1),n.addEventListener("MSPointerDown",function(t){s.touchStart(t,i)},!1),n.addEventListener("MSPointerUp",function(t){s.touchEnd(t,i)},!1)},unbind:function(t){var e=this.bindings[t];this.delayedKeyup[e]=!0,this.bindings[t]=null},unbindAll:function(){this.bindings={},this.actions={},this.presses={},this.locks={},this.delayedKeyup={}},state:function(t){return this.actions[t]},pressed:function(t){return this.presses[t]},released:function(t){return!!this.delayedKeyup[t]},clearPressed:function(){for(var t in this.delayedKeyup)this.actions[t]=!1,this.locks[t]=!1;this.delayedKeyup={},this.presses={}},touchStart:function(t,e){return this.actions[e]=!0,this.presses[e]=!0,t.stopPropagation(),t.preventDefault(),!1},touchEnd:function(t,e){return this.delayedKeyup[e]=!0,t.stopPropagation(),t.preventDefault(),!1}})})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){t.Loader=t.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(t,e){this.gameClass=t,this.resources=e,this._loadCallbackBound=this._loadCallback.bind(this);for(var i=0;i<this.resources.length;i++)this._unloaded.push(this.resources[i].path)},load:function(){if(t.system.clear("#000"),!this.resources.length)return void this.end();for(var e=0;e<this.resources.length;e++)this.loadResource(this.resources[e]);this._intervalId=setInterval(this.draw.bind(this),16)},loadResource:function(t){t.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId),t.system.setGame(this.gameClass))},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var e=t.system.scale,i=.6*t.system.width,n=.1*t.system.height,s=.5*t.system.width-i/2,o=.5*t.system.height-n/2;t.system.context.fillStyle="#000",t.system.context.fillRect(0,0,480,320),t.system.context.fillStyle="#fff",t.system.context.fillRect(s*e,o*e,i*e,n*e),t.system.context.fillStyle="#000",t.system.context.fillRect(s*e+e,o*e+e,i*e-e-e,n*e-e-e),t.system.context.fillStyle="#fff",t.system.context.fillRect(s*e,o*e,i*e*this._drawStatus,n*e)},_loadCallback:function(t,e){if(!e)throw"Failed to load resource: "+t;this._unloaded.erase(t),this.status=1-this._unloaded.length/this.resources.length,0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.map").defines(function(){t.Map=t.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(t,e){this.tilesize=t,this.data=e,this.height=e.length,this.width=e[0].length,this.pxWidth=this.width*this.tilesize,this.pxHeight=this.height*this.tilesize},getTile:function(t,e){var i=Math.floor(t/this.tilesize),n=Math.floor(e/this.tilesize);return i>=0&&i<this.width&&n>=0&&n<this.height?this.data[n][i]:0},setTile:function(t,e,i){var n=Math.floor(t/this.tilesize),s=Math.floor(e/this.tilesize);n>=0&&n<this.width&&s>=0&&s<this.height&&(this.data[s][n]=i)}})})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.sound").defines(function(){t.SoundManager=t.Class.extend({clips:{},volume:1,format:null,init:function(){if(!t.Sound.enabled||!window.Audio)return void(t.Sound.enabled=!1);for(var e=new Audio,i=0;i<t.Sound.use.length;i++){var n=t.Sound.use[i];if(e.canPlayType(n.mime)){this.format=n;break}}this.format||(t.Sound.enabled=!1)},load:function(e,i,n){var s=t.prefix+e.replace(/[^\.]+$/,this.format.ext)+t.nocache;if(this.clips[e]){if(i&&this.clips[e].length<t.Sound.channels)for(var o=this.clips[e].length;o<t.Sound.channels;o++){var a=new Audio(s);a.load(),this.clips[e].push(a)}return this.clips[e][0]}var r=new Audio(s);if(n&&(r.addEventListener("canplaythrough",function t(i){r.removeEventListener("canplaythrough",t,!1),n(e,!0,i)},!1),r.addEventListener("error",function(t){n(e,!1,t)},!1)),r.preload="auto",r.load(),this.clips[e]=[r],i)for(var o=1;o<t.Sound.channels;o++){var a=new Audio(s);a.load(),this.clips[e].push(a)}return r},get:function(t){for(var e,i=this.clips[t],n=0;e=i[n++];)if(e.paused||e.ended)return e.ended&&(e.currentTime=0),e;return i[0].pause(),i[0].currentTime=0,i[0]}}),t.Music=t.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:!1,_volume:1,_loop:!1,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this),Object.defineProperty?(Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)}),Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)})):this.__defineGetter__&&(this.__defineGetter__("volume",this.getVolume.bind(this)),this.__defineSetter__("volume",this.setVolume.bind(this)),this.__defineGetter__("loop",this.getLooping.bind(this)),this.__defineSetter__("loop",this.setLooping.bind(this)))},add:function(e,i){if(t.Sound.enabled){var n=e instanceof t.Sound?e.path:e,s=t.soundManager.load(n,!1);s.loop=this._loop,s.volume=this._volume,s.addEventListener("ended",this._endedCallbackBound,!1),this.tracks.push(s),i&&(this.namedTracks[i]=s),this.currentTrack||(this.currentTrack=s)}},next:function(){this.tracks.length&&(this.stop(),this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length,this.currentTrack=this.tracks[this.currentIndex],this.play())},pause:function(){this.currentTrack&&this.currentTrack.pause()},stop:function(){this.currentTrack&&(this.currentTrack.pause(),this.currentTrack.currentTime=0)},play:function(t){if(t&&this.namedTracks[t]){var e=this.namedTracks[t];e!=this.currentTrack&&(this.stop(),this.currentTrack=e)}else if(!this.currentTrack)return;this.currentTrack.play()},getLooping:function(){return this._loop},setLooping:function(t){this._loop=t;for(var e in this.tracks)this.tracks[e].loop=t},getVolume:function(){return this._volume},setVolume:function(t){this._volume=t.limit(0,1);for(var e in this.tracks)this.tracks[e].volume=this._volume},fadeOut:function(e){this.currentTrack&&(clearInterval(this._fadeInterval),this.fadeTimer=new t.Timer(e),this._fadeInterval=setInterval(this._fadeStep.bind(this),50))},_fadeStep:function(){var t=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;t<=.01?(this.stop(),this.currentTrack.volume=this._volume,clearInterval(this._fadeInterval)):this.currentTrack.volume=t},_endedCallback:function(){this._loop?this.play():this.next()}}),t.Sound=t.Class.extend({path:"",volume:1,currentClip:null,multiChannel:!0,init:function(t,e){this.path=t,this.multiChannel=e!==!1,this.load()},load:function(e){return t.Sound.enabled?void(t.ready?t.soundManager.load(this.path,this.multiChannel,e):t.addResource(this)):void(e&&e(this.path,!0))},play:function(){t.Sound.enabled&&(this.currentClip=t.soundManager.get(this.path),this.currentClip.volume=t.soundManager.volume*this.volume,this.currentClip.play())},stop:function(){this.currentClip&&(this.currentClip.pause(),this.currentClip.currentTime=0)}}),t.Sound.FORMAT={MP3:{ext:"mp3",mime:"audio/mpeg"},M4A:{ext:"m4a",mime:"audio/mp4; codecs=mp4a"},OGG:{ext:"ogg",mime:"audio/ogg; codecs=vorbis"},WEBM:{ext:"webm",mime:"audio/webm; codecs=vorbis"},CAF:{ext:"caf",mime:"audio/x-caf"}},t.Sound.use=[t.Sound.FORMAT.OGG,t.Sound.FORMAT.MP3],t.Sound.channels=4,t.Sound.enabled=!0})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.system").requires("impact.timer","impact.image").defines(function(){t.System=t.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:!1,delegate:null,clock:null,canvas:null,context:null,init:function(e,i,n,s,o){this.fps=i,this.clock=new t.Timer,this.canvas=t.$(e),this.resize(n,s,o),this.context=this.canvas.getContext("2d"),this.getDrawPos=t.System.drawMode,1!=this.scale&&(t.System.scaleMode=t.System.SCALE.CRISP),t.System.scaleMode(this.canvas,this.context)},resize:function(t,e,i){this.width=t,this.height=e,this.scale=i||this.scale,this.realWidth=this.width*this.scale,this.realHeight=this.height*this.scale,this.canvas.width=this.realWidth,this.canvas.height=this.realHeight},setGame:function(t){this.running?this.newGameClass=t:this.setGameNow(t)},setGameNow:function(e){t.game=new e,t.system.setDelegate(t.game)},setDelegate:function(t){if("function"!=typeof t.run)throw"System.setDelegate: No run() function in object";this.delegate=t,this.startRunLoop()},stopRunLoop:function(){t.clearAnimation(this.animationId),this.running=!1},startRunLoop:function(){this.stopRunLoop(),this.animationId=t.setAnimation(this.run.bind(this),this.canvas),this.running=!0},clear:function(t){this.context.fillStyle=t,this.context.fillRect(0,0,this.realWidth,this.realHeight)},run:function(){t.Timer.step(),this.tick=this.clock.tick(),this.delegate.run(),t.input.clearPressed(),this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null)},getDrawPos:null}),t.System.DRAW={AUTHENTIC:function(t){return Math.round(t)*this.scale},SMOOTH:function(t){return Math.round(t*this.scale)},SUBPIXEL:function(t){return t*this.scale}},t.System.drawMode=t.System.DRAW.SMOOTH,t.System.SCALE={CRISP:function(e,i){t.setVendorAttribute(i,"imageSmoothingEnabled",!1),e.style.imageRendering="-moz-crisp-edges",e.style.imageRendering="-o-crisp-edges",e.style.imageRendering="-webkit-optimize-contrast",e.style.imageRendering="crisp-edges",e.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(e,i){t.setVendorAttribute(i,"imageSmoothingEnabled",!0),e.style.imageRendering="",e.style.msInterpolationMode=""}},t.System.scaleMode=t.System.SCALE.SMOOTH})}).call(window)}).call(e,i(1))},function(t,e,i){(function(t){(function(){"use strict";t.module("impact.timer").defines(function(){t.Timer=t.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(e){this.base=t.Timer.time,this.last=t.Timer.time,this.target=e||0},set:function(e){this.target=e||0,this.base=t.Timer.time,this.pausedAt=0},reset:function(){this.base=t.Timer.time,this.pausedAt=0},tick:function(){var e=t.Timer.time-this.last;return this.last=t.Timer.time,this.pausedAt?0:e},delta:function(){return(this.pausedAt||t.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||(this.pausedAt=t.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=t.Timer.time-this.pausedAt,this.pausedAt=0)}}),t.Timer._last=0,t.Timer.time=Number.MIN_VALUE,t.Timer.timeScale=1,t.Timer.maxStep=.05,t.Timer.step=function(){var e=Date.now(),i=(e-t.Timer._last)/1e3;t.Timer.time+=Math.min(i,t.Timer.maxStep)*t.Timer.timeScale,t.Timer._last=e}})}).call(window)}).call(e,i(1))},function(t,e){(function(){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}}).call(window)}]);